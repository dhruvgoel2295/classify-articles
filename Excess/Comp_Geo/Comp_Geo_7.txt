Computational Geometry 48 (2015) 606–621

Contents lists available at ScienceDirect

Computational Geometry: Theory and
Applications
www.elsevier.com/locate/comgeo

Homological reconstruction and simpliﬁcation in R3
Dominique Attali a , Ulrich Bauer b,∗ , Olivier Devillers c , Marc Glisse d ,
André Lieutier e
a

Gipsa-lab, Saint Martin d’Hères, France
IST Austria, Klosterneuburg, Austria
c
INRIA Sophia Antipolis - Méditerranée, Sophia Antipolis, France
d
INRIA Saclay - Île-de-France, Orsay, France
e
Dassault Système, Aix-en-Provence, France
b

a r t i c l e

i n f o

Article history:
Available online 26 August 2014
Keywords:
NP-hard problems
Homology
Persistence

a b s t r a c t
We consider the problem of deciding whether the persistent homology group of a
simplicial pair ( K , L ) can be realized as the homology H ∗ ( X ) of some complex X with
L ⊂ X ⊂ K . We show that this problem is NP-complete even if K is embedded in R3 .
As a consequence, we show that it is NP-hard to simplify level and sublevel sets of scalar
functions on S3 within a given tolerance constraint. This problem has relevance to the
visualization of medical images by isosurfaces. We also show an implication to the theory
of well groups of scalar functions: not every well group can be realized by some level set,
and deciding whether a well group can be realized is NP-hard.
© 2014 Elsevier B.V. All rights reserved.

1. Introduction
In this paper, we establish NP-completeness of a variety of related problems that ask for an object in R3 with certain
prescribed topological constraints.
In the most basic setting, we have a point cloud in Rd that samples a shape and we want to retrieve information on the
sampled shape. There exists a whole spectrum of possibilities regarding the type of sought information. At the coarsest level,
we can content ourselves with the homology groups which record the “holes” of a given dimension, hereafter referred to
as homological features (connected components, cycles, cavities and so on). At a ﬁner level, we may be interested in building
an approximation of the shape, reﬂecting as accurately as possible both its geometry and topology. The standard way is to
construct a simplicial complex using the data points as vertices, such as for instance the α -complex, the Rips complex or
ˇ
the Cech
complex [1,2]. All three constructions have in common to depend upon a scale parameter α and to get bigger
as α increases. In the ideal case, we expect the complex to have the right homology for some suitable value of α [3–6].
Unfortunately, depending on the sampling, it may happen that such a value of α does not exist. Nonetheless, we might still
be able to infer the true homology of the shape hidden in the noisy data using persistent homology [7–9]. Given two scale
parameters α1 and α2 , the persistent homology groups record the homological features that persist from α1 to α2 . Under

*

Corresponding author.
E-mail addresses: mail@ulrich-bauer.org (U. Bauer), Andre.LIEUTIER@3ds.com (A. Lieutier).
URLs: http://www.gipsa-lab.grenoble-inp.fr/ (D. Attali), http://ulrich-bauer.org (U. Bauer), http://www-sop.inria.fr/members/Olivier.Devillers/
(O. Devillers), http://geometrica.saclay.inria.fr/team/Marc.Glisse/ (M. Glisse).
http://dx.doi.org/10.1016/j.comgeo.2014.08.010
0925-7721/© 2014 Elsevier B.V. All rights reserved.

D. Attali et al. / Computational Geometry 48 (2015) 606–621

607

very weak hypotheses, we know that the persistent homology is precisely that of the sampled shape [8,10]. The persistent
homology can be computed eﬃciently (i.e., in polynomial time).
A natural question is then to ask for a complex that carries the persistent homology: given a complex K and a subcomplex L, can we ﬁnd a subcomplex of K that contains L and whose homological features are precisely those common to L
and K ? Our answer is that sometimes we cannot, and deciding whether we can is NP-complete. This answer was ﬁrst given
in the general case by Attali and Lieutier [11], who posed the restriction to complexes embedded in R3 as an open problem.
We resolve this problem by proving NP-completeness even for complexes embedded in R3 .
The above problem concentrates on building a complex whose homology matches perfectly the persistent homology of L
into K : all the homological noise has been removed. We call such an object a homological reconstruction. However, when it
does not exist, it is still relevant to look for a complex nested between L and K and whose homology is as close as possible
to the persistent homology of L into K : as much noise as possible has been removed. We call such a complex a homological
simpliﬁcation and prove that ﬁnding one is also an NP-hard problem.
In the ﬁeld of visualization and image analysis, another common setting consists in describing a shape through a continuous function f : Rd → R instead of a point cloud in Rd . For instance, a medical image may be a collection of density
measurements over a grid of 3D points and is best modeled as a continuous map over a certain domain of R3 . In the ideal
case, the shape is a sublevel set of the function, f −1 (−∞, t ]. Unfortunately, noise can plague the data. As the parameter t
increases, sublevel sets inﬂate and we can track the evolution of their homology. Features that appear and disappear quickly
are considered topological noise, and we can consider the common features of two sublevel sets as those of a denoised sublevel set. The question now becomes: can we ﬁnd another cleaner function, close enough to the original one, whose sublevel
set has the denoised homology, i.e., a sublevel set reconstruction? The corresponding optimization problem asks for a sublevel
set simpliﬁcation, i.e., a function close to the original one that minimizes the number of homological features of the sublevel
set. We show that these two problems are the equivalents in the functional setting to the homological reconstruction and
simpliﬁcation of simplicial pairs described above.
Often, one is also interested in the homology of a level set, f −1 (t ). We show how it can be related to the (persistent)
homology of sublevel sets, and consider the corresponding level set reconstruction/simpliﬁcation problems.
Further in this direction, Edelsbrunner et al. introduced the well group [12,13] as a denoised version of the homology
group of a level set. Again, we can ask whether one can ﬁnd a realization of the well group, i.e., a cleaner function whose
level set has the same homology as the well group?
We shall see in this paper that all of these related problems are NP-hard, as a consequence of the NP-completeness of
the homological reconstruction problem.
1.1. Background and notation
We are only concerned with topological spaces that are triangulable by a ﬁnite simplicial complex, so simplicial and
singular homologies are isomorphic and we make no distinction between the two. In particular, we use the simplicial
versions of the Excision and Mayer–Vietoris sequence theorems, which have less restrictive assumptions than their singular
counterparts. If K is an abstract simplicial complex, we denote by K its geometric realization. Throughout this article, we
consider homology with coeﬃcients in an arbitrary ﬁeld F, so the homology groups are ﬁnite-dimensional F-vector spaces
and there is no torsion. Note that for simplicial complexes K embedded in R3 , this is in fact not a restriction, since due to
the absence of torsion in R3 the Betti numbers are independent of the choice of coeﬃcients (see, e.g., [14, §3.3]).
Given a topological space K, we write H ∗ (K) = i H i (K) for the direct sum of homology groups in all dimensions, and
β(K) = i ≥0 βi (K) for the total Betti number. If (K, L) is a pair of topological spaces L ⊂ K, the inclusion L → K induces
a homomorphism H ∗ (L) → H ∗ (K), which is denoted by H ∗ (L → K). The rank of this map is the persistent Betti number of
the inclusion L → K and is denoted by β(L → K) = rank H ∗ (L → K); the image im H ∗ (L → K) is a persistent homology
group. If ( K , L ) is a simplicial pair, that is, a pair of simplicial complexes such that L ⊂ K , then the persistent Betti number
β( L → K ) can be computed in time cubic in the number of simplices in K [7]. This cubic complexity can be improved to
matrix multiplication time [15].
A piecewise linear function on a topological space K is a continuous function f : K → R such that there exists a ﬁnite
triangulation of K on which f is simplexwise linear. Note that a simplexwise linear function must be linear on each simplex
of the given triangulation, while a piecewise linear function is linear on each simplex of some arbitrary triangulation.
2. Reconstruction and simpliﬁcation of simplicial pairs
In this section, we consider a simplicial pair and deﬁne the homological reconstruction problem and the homological
simpliﬁcation problem. We prove that both problems are NP-hard when the simplicial pair is embedded in R3 . We start
with a simple lemma:
Lemma 1. Consider a triple of topological spaces L ⊂ X ⊂ K with ﬁnite Betti numbers. Then

β(X ) ≥ β(L → K).

608

D. Attali et al. / Computational Geometry 48 (2015) 606–621

Fig. 1. Example of a simplicial pair ( K , L ) embedded in R3 that has no homological reconstruction.

Fig. 2. Example of a simplicial pair (left) having a homological reconstruction as a subspace (right), but not as a subcomplex. The simplicial complex on the
left contains three tetrahedra sharing an edge and whose union forms a triangular bipyramid.

Proof. This is a consequence of the fact that whenever we consider two linear maps j : U → V and i : V → W between
ﬁnite-dimensional vector spaces, then dim V ≥ rank j ≥ rank i ◦ j. ✷
This property suggests the following deﬁnition:
Deﬁnition 1. Consider a triple of topological spaces L ⊂ X ⊂ K with ﬁnite Betti numbers. Then X is called a homological
reconstruction of (K, L) if β(X ) = β(L → K). Moreover, X is called a homological p-reconstruction of (K, L) if β p (X ) =
β p (L → K).
We will often omit “homological” since there is no ambiguity in this paper. An equivalent condition for X being a
reconstruction is that H ∗ (L → X ) is surjective and H ∗ (X → K) is injective, as deﬁned in [11]. Not every pair (K, L)
admits a reconstruction; a simple counterexample is shown in Fig. 1. The use of topological spaces in the deﬁnition (as
opposed to simplicial complexes) is motivated by the following observation. Let ( K , L ) be a simplicial pair. Then there
might be a reconstruction of ( K , L ), but not as a subcomplex of K . An example is shown in Fig. 2. A reconstruction that is
a subcomplex is called a subcomplex reconstruction. To emphasize the distinction to this case, we sometimes use the term
subspace reconstruction to emphasize that the reconstruction is only required to be a subspace, not necessarily a subcomplex.
2.1. Homological reconstruction is NP-hard
We now focus our attention on spaces that are geometric realizations of ﬁnite simplicial complexes embedded in R3 .
Theorem 1. The homological reconstruction problem is NP-hard: Given as input a simplicial pair ( K , L ) embedded in R3 , decide
whether there exists a subspace reconstruction X of ( K , L ). The problem is NP-complete if X is required to be a subcomplex.
This section is devoted to the proof of Theorem 1 by reduction from 3-SAT. Recall that a Boolean formula Φ is in 3-CNF
if it is a conjunction of several clauses, each of which is a disjunction of three literals, a literal being either a variable or its
negation. Given a 3-CNF formula Φ , we construct a simplicial pair ( K Φ , L Φ ) embedded in R3 and prove that ( K Φ , L Φ ) has
a reconstruction (as a subcomplex of K Φ ) if and only if Φ has a satisfying assignment (see Lemmas 2 and 3 below).
For this, we associate to the 3-CNF formula Φ a simplicial pair ( K Φ , L Φ ) with trivial persistent homology. Equivalently,
any reconstruction X of ( K Φ , L Φ ) has trivial homology, i.e.,

βd (X ) = βd ( L Φ → K Φ ) = 1 if d = 0,
0

otherwise.

This means that X has a single connected component, no loops, and no cavities. X has to ﬁll all loops or cavities in L Φ and
has to connect the different connected components of L Φ by adding to L Φ portions of K Φ without creating any new loops
or cavities.
The variable gadget The variable gadget is a simplicial pair ( V i , W i ) as depicted in Fig. 3, top. The simplicial complex V i
contains 4 edges forming a cycle. The two bold edges do not belong to W i . One of the bold edges will be called Truei
and the other one will be called Falsei . The key property of this construction is that any reconstruction of the pair ( V i , W i )

D. Attali et al. / Computational Geometry 48 (2015) 606–621

609

Fig. 3. Variable (top) and clause (bottom) gadgets for the reduction of homological reconstruction to 3-SAT.

cannot contain both edges Truei and Falsei , for otherwise they would form a 1-cycle with the remaining edges. This property
will allow us to match the presence of the edge Truei to a true assignment of the variable v i .
The clause gadget The clause gadget is a simplicial pair (C j , D j ) as depicted in Fig. 3, bottom. The simplicial complex D j
contains a cycle ABCDE. The cycle is closed with two surfaces in C j (thereafter referred to as the lower hemisphere and the
disk) thereby creating a cavity. Furthermore, the complex D j contains an arc that ends inside the disk. Whenever we ﬁll the
cycle ABCDE with the disk, this connects the two endpoints of the arc, thus creating a new cycle, which we close twice in
C j by a left hemisphere and a right hemisphere. Consider one bold edge in the interior of each hemisphere, which is where
the clause gadget will connect to the variable gadgets.
The key property of this clause gadget is that at least one of the 3 bold edges must be present in any reconstruction X
of the pair (C j , D j ). Indeed, the cycle ABCDE in X must be ﬁlled up. If it is ﬁlled by the lower hemisphere, we are done.
If it is ﬁlled by the disk, we have a new cycle EFGH in X which in turn must be killed either by the left or by the right
hemisphere. In any case, X contains at least one of the hemispheres and thus one of the three bold edges.
Correspondence with a formula Given a 3-CNF formula Φ with n clauses c 1 , . . . , cn and m variables v 1 , . . . , v m , we construct
a 2-dimensional pair ( K Φ , L Φ ) as follows. For each variable v i we take a copy ( V i , W i ) of the variable gadget. For each
clause c j , we take a copy (C j , D j ) of the clause gadget; for each literal ev i of c j , we identify one of the bold edges of C j to
Falsei if e is a negation and Truei otherwise. See Fig. 4 for an example.
First notice that β2 ( L Φ ) = 0 (i.e., L Φ has no cavities). Second, we can assume that β0 ( K Φ ) = 1 (i.e., K Φ is connected).
Indeed, if K Φ is disconnected, it means that the 3-SAT problem (and the reconstruction problem) can be decomposed into
2 independent subproblems with disjoint sets of variables, which can be solved separately. Last, β1 ( L Φ → K Φ ) = 0 (i.e., the
cycles in L Φ are boundaries in K Φ ). Indeed, the only 1-cycles in L Φ are the 1-cycles ABCDE in each D j , and they are ﬁlled
in K Φ . This means that we are looking for a reconstruction with trivial homology.
From a reconstruction to a satisfying assignment Let X be a homological reconstruction of the pair ( K Φ , L Φ ). We do not
assume that X is the geometric realization of some subcomplex of K Φ . Assign to each variable v i the value true if the edge
Truei is entirely contained in X , and false otherwise. For each clause gadget (C j , D j ), at least one bold edge is contained
in X . If this edge corresponds to a positive literal v i , this means that Truei is in X , v i is true and the clause is satisﬁed. If
the edge corresponds to a negative literal ¬ v i , this implies that Falsei is in X . Truei is thus not in X , so v i was assigned
false and the clause is satisﬁed. We have thus shown that the assignment of the variables makes the formula evaluate to
true:
Lemma 2. If ( K Φ , L Φ ) has a homological reconstruction, then Φ has a satisfying assignment.
From a satisfying assignment to a reconstruction Given a satisfying assignment for the formula Φ , we construct a subcomplex
reconstruction X of ( K Φ , L Φ ). We start with X = L Φ and add to X a selected set of simplices from K Φ . For each clause c j ,
we pick one literal that evaluates to true and close the cycle in the clause gadget complex D j correspondingly. If the
literal corresponds to the bold edge of the lower hemisphere, we add this hemisphere. Otherwise, we add the disk and the
hemisphere that contains the bold edge corresponding to the selected literal.
The only 2-cycles in K Φ are in the clause gadgets. As we did not create any 2-cycle in X , it follows that β2 ( X ) = 0. By
construction, ﬁlling the clause gadgets never introduced both Truei and Falsei in X . Indeed, it could only introduce Truei if

610

D. Attali et al. / Computational Geometry 48 (2015) 606–621

Fig. 4. Embedding of the clause gadget with aligned hemispheres (top), and the simplicial complex K Φ generated in the reduction from the 3-SAT instance
(¬t ∧ u ∧ v ) ∨ (t ∧ ¬ v ∧ ¬ w ) ∨ (¬u ∧ ¬ v ∧ w ) (bottom left), with parallel projection (bottom right) orthogonal to the alignment axis of the variable gadgets.

v i was assigned the value true and Falsei if it was assigned the value false. Therefore, the 1-cycle in the variable gadgets
do not appear in X . Also, for each clause gadget, we ﬁlled the ABCDE 1-cycle, and whenever we created an extra EFGH
1-cycle by adding the disk, we immediately ﬁlled it with the left or right hemisphere. Now we only need to check that
the construction did not create any “non-local” 1-cycles. Since for each clause we have only used one of the literals which
evaluate to true, the only contact a clause gadget in X has with the rest of X is through a single bold edge, and the clause
gadget can be collapsed to that edge. After collapsing all clause gadgets, all that remain are disconnected variable gadgets
with at most 3 edges each, and so β1 ( X ) = 0. We ﬁnally add to X just enough edges from K Φ so that it becomes connected,
without creating any extra cycles in the process. This is possible since we assumed that K Φ is connected. Thus we have
β0 ( X ) = 1. We conclude:
Lemma 3. If Φ has a satisfying assignment, then ( K Φ , L Φ ) has a subcomplex reconstruction.
We are now in a position to prove Theorem 1.
Proof of Theorem 1. First we show that the homological reconstruction problem is NP-hard. We proceed by reduction from
3-SAT. Let ( K , L ) = ( K Φ , L Φ ) be a simplicial pair deﬁned by a 3-SAT instance Φ . We show that the following propositions
are equivalent:
(a) ( K , L ) has a subspace reconstruction;
(b) Φ has a satisfying assignment;
(c) ( K , L ) has a subcomplex reconstruction.
The implication (a) ⇒ (b) is shown in Lemma 2; (b) ⇒ (c) is shown in Lemma 3. Finally, (c) ⇒ (a) is trivial.
The pair ( K , L ) can be constructed from Φ in time polynomial in the size of Φ . Together with the equivalence (a) ⇐⇒ (b),
this establishes NP-hardness of the homological reconstruction problem.
The equivalence (b) ⇐⇒ (c) also yields NP-hardness of the subcomplex reconstruction problem. Moreover, given a subcomplex X as a polynomial size certiﬁcate, we can decide in polynomial time whether X is a reconstruction of ( K , L ). Thus
the problem is also in NP and hence NP-complete. ✷

D. Attali et al. / Computational Geometry 48 (2015) 606–621

611

Fig. 5. Example of 3-SAT reduction using a 3D grid embedding.

Embedding Later, we have to consider not only an embedding of K Φ , but also a triangulation of its complement. The
following fact will be useful:
Lemma 4. There is a triangulation of S3 with size polynomial in the size of K Φ and having K Φ as a subcomplex.
Proof. First, referring to Fig. 4, it is clear that K Φ can be embedded in R3 . Indeed, we can align the clause gadgets and the
variable gadgets along two lines parallel to the coordinate axes and make each clause gadget look like a small body with
three long tentacles that connect to the variable gadgets. Due to the way the variable and clause gadgets are aligned in the
construction along skew axes, the tentacles do not intersect in their interior.
We can subdivide the space by ﬁrst projecting K Φ onto a plane orthogonal to the line carrying the variable gadgets.
We get a polygonal region whose complement can easily be triangulated inside a bounding box without adding any new
vertex and thus adding a linear number of edges. Extending each triangle in the direction of the projection, we get a
collection of tubes, one for each triangle. The tubes can easily be triangulated while respecting K Φ to obtain a polynomial
size triangulation of a bounding box of the construction, which can trivially be extended to a polynomial size triangulation
of S3 . ✷
We want to remark that a similar construction can be realized even if we restrict edges and faces of L and K to be edges
and faces of a 3D grid (see Fig. 5). This means that a variant of Theorem 1 can also be shown for cubical complexes arising
from 3D image data.
Corollary 1. The homological simpliﬁcation problem is NP-hard: Given as input a simplicial pair ( K , L ) embedded in R3 , ﬁnd a complex
X minimizing β( X ) subject to L ⊂ X ⊂ K .
Proof. We use a reduction from the subcomplex reconstruction problem. To determine if a subcomplex reconstruction
exists, we can ﬁrst ﬁnd a complex X minimizing β( X ) subject to L ⊂ X ⊂ K . We then only need to check if its Betti number
matches the lower bound β( L → K ). ✷
3. Reconstruction and simpliﬁcation of level and sublevel sets
In this section, we consider a real-valued simplexwise linear function deﬁned on a simplicial complex embedded in R3
and establish the NP-hardness of problems that ask for a nearby function with a simpliﬁed sublevel set (Section 3.1) and a
simpliﬁed level set (Section 3.3).
Given a real-valued function f , we write F t for the t-level set f −1 (t ), F ≤t for the (closed) t-sublevel set f −1 ((−∞, t ]), and
F <t for the open t-sublevel set f −1 ((−∞, t )). In this paper we shall only consider real-valued piecewise linear functions. Note
that level and sublevel sets of a simplexwise linear function on a simplicial complex K are not necessarily subcomplexes
of K , but subcomplexes of an appropriate subdivision of K . Moreover, we have the following property:
Proposition 1. (See Kühnel [16], Morozov [17].) Let f be a simplexwise linear function on a simplicial complex K . Let K (t ) be the
induced subcomplex of K on { v ∈ vert K : f ( v ) ≤ t }. Then K (t ) is homotopy equivalent to the sublevel set F ≤t . If t = f ( v ) for all
v ∈ vert K , then K (t ) is also homotopy equivalent to the open sublevel set F <t .

612

D. Attali et al. / Computational Geometry 48 (2015) 606–621

Fig. 6. Top: A simplicial pair ( K , L ) and a homological reconstruction of ( K , L ) as a subcomplex. Bottom: values of f (left) and g (right) at the vertices of
the barycentric subdivision sd K , as used in the proof of Theorem 2.

Deﬁnition 2. Let f , g be piecewise linear functions and consider real parameters t and δ . The function g is called a sublevel
set (t , δ)-reconstruction of f if g − f ∞ ≤ δ and G ≤t is a reconstruction of the pair ( F ≤t +δ , F ≤t −δ ), i.e.,

β(G ≤t ) = β( F ≤t −δ → F ≤t +δ ).
Note that

F ≤t −δ ⊆ G ≤t ⊆ F ≤t +δ ,
so that

β(G ≤t ) ≥ β( F ≤t −δ → F ≤t +δ ).
A sublevel set (t , δ)-reconstruction is thus also a minimizer of β(G ≤t ) subject to

g − f ∞ ≤ δ.

3.1. Sublevel set reconstruction is NP-hard
Theorem 2. The sublevel set reconstruction problem is NP-hard: Given as input a simplexwise linear function f on a simplicial complex
embedded in R3 and parameters t and δ , decide whether there exists a sublevel set (t , δ)-reconstruction g of f .
Proof. It suﬃces to establish the theorem for t = 0 and δ = 1. We proceed by reduction from 3-SAT using the results of
the previous section. Let ( K , L ) = ( K Φ , L Φ ) be a simplicial pair deﬁned by a 3-SAT instance Φ , as described in the proof
of Theorem 1. We construct an instance of the level set simpliﬁcation problem by deﬁning a simplexwise linear function
f : sd K → R on the barycentric subdivision of K ; see Fig. 6. Recall that the barycentric subdivision (or derived subdivision) of
a simplicial complex K is the order complex of the face relation, i.e., the abstract simplicial complex sd K whose vertices are
the simplices of K and whose simplices are the totally ordered subsets of K with regard to the face relation. We deﬁne f
via its values on the vertices of sd K . Using the fact that a vertex σ of sd K is a simplex of K , we let

f :σ →

−2 if σ ∈ L ,
0

otherwise.

(1)

Note that for every function g with g − f ∞ ≤ 1, the 0-sublevel set G ≤0 contains L and is contained in K . We show
that the following propositions are equivalent to propositions (a)–(c) in the proof of Theorem 1:
4. f has a simplexwise linear sublevel set (0, 1)-reconstruction g.
5. f has a sublevel set (0, 1)-reconstruction g.
To show (c) ⇒ (d), we deﬁne a simplexwise linear function g on sd K by its values on the vertices of sd K (the simplices
of K ); see Fig. 6:

g:σ →

−2 if σ ∈ L ,
−1 if σ ∈ X \ L ,
1
if σ ∈ K \ X .

(2)

We have g − f ∞ = 1. By Proposition 1, the sublevel set G ≤0 is homotopy equivalent to | X | and hence is a reconstruction
of the pair

D. Attali et al. / Computational Geometry 48 (2015) 606–621

(K , L)

613

( F ≤1 , F ≤−1 ).

Finally, (d) ⇒ (e) is trivial and (e) ⇒ (a) follows directly with G ≤0 as a reconstruction of ( F ≤1 , F ≤−1 ) ( K , L ).
The function f can be constructed from the 3-SAT instance Φ in polynomial time. Together with the equivalence
(b) ⇐⇒ (e), this establishes NP-hardness of the sublevel set reconstruction problem.
The equivalence (b) ⇐⇒ (d) also yields NP-hardness of the sublevel set reconstruction problem restricted to simplexwise
linear functions sd K → R. ✷
Theorem 3. The sublevel set reconstruction problem is NP-complete if the reconstruction is required to be simplexwise linear on the
same complex.
Proof. By Theorem 2, it is suﬃcient to show that the problem is in NP, i.e. every “yes” instance f : K → R has certiﬁcate
with size polynomial in the size of K and f . Again, it suﬃces to establish the theorem for t = 0 and δ = 1. We show that
there is a simplexwise linear (0, 1)-reconstruction g iff there is a subset of vertices S whose induced subcomplex K S is a
reconstruction of ( K (1), K (−1)), where K (t ) is the induced subcomplex of K on { v ∈ vert K : f ( v ) ≤ t } as in Proposition 1.
The subset of vertices v with g ( v ) ≤ 0 induces a subcomplex that is homotopy equivalent to the sublevel set G ≤0 ,
by Proposition 1. Vice versa, let S be a subset of vertices such that the induced subcomplex K S is a reconstruction of
( K (1), K (−1)). In particular, for all v ∈ S we have f ( v ) ≤ 1, and for all v ∈
/ S we have f ( v ) > −1. Deﬁne a simplexwise
linear function by the vertex values

h:v→

f ( v ) − 1 if v ∈ S ,
f ( v ) + 1 if v ∈
/ S,

and note that for each vertex v, h( v ) ≤ 0 if and only if v ∈ S. By Proposition 1, the sublevel set H ≤0 is homotopy equivalent
to the induced subcomplex K S and hence is a reconstruction of the pair ( F ≤1 , F ≤−1 ) ( K (1), K (−1)). We conclude that h
is a (0, 1)-reconstruction of f .
Given a subset S as a polynomial size certiﬁcate, by computing and comparing β( K S ) and β( K (−1) → K (1)) we can
verify in polynomial time the existence of a sublevel set (0, 1)-reconstruction of f . Thus the problem is also in NP and
hence NP-complete. ✷
Corollary 2. The sublevel set simpliﬁcation problem is NP-hard: Given as input a simplexwise linear function f on a simplicial complex
embedded in R3 and parameters t and δ , ﬁnd a simplexwise linear function g minimizing β(G ≤t ) subject to g − f ∞ ≤ δ .
Proof. We use a reduction from the sublevel set reconstruction problem. To determine if f has a sublevel set
(t , δ)-reconstruction, we can ﬁrst ﬁnd a simplexwise linear minimizer of β(G ≤t ). We then only need to check if β(G ≤t )
matches the lower bound

β( F ≤t −δ → F ≤t +δ ),
which can be done in time polynomial in the size of K .

✷

3.2. Betti numbers of level and sublevel sets
The Betti numbers of level and sublevel sets are related by the following formula:
Lemma 5. Let f be a piecewise linear function on Sn , n > 1, and let t be in the interior of the image of f , t ∈ int(im f ). Then

βd ( F t ) = βd ( F ≤t ) + βn−d−1 ( F <t ).
Proof. First recall that F ≤t , F ≥t , and F ≥t are subcomplexes of an appropriate triangulation of Sn , so we can apply the
simplicial version of the Mayer–Vietoris theorem [18, §4.6]. By exactness of the Mayer–Vietoris sequence for Sn , F ≤t , and
F ≥t , we have [19]

βd ( F t ) = βd ( F ≤t ) + βd ( F ≥t ) +

−1 if d = 0,
1
if d = n − 1,
0
otherwise.

(3)

By Alexander duality [14, §3.3], the duality of homology and cohomology with ﬁeld coeﬃcients resulting from the universal
coeﬃcient theorem [14, §3.1], and isomorphism of dual ﬁnite-dimensional vector spaces, we have

H d ( F ≥t ) ∼
= H n−d−1 ( F <t ) ∼
= Hom H n−d−1 ( F <t ), F ∼
= H n−d−1 ( F <t ),
where H d denotes the dth reduced homology group and Hom( H n−d−1 ( F <t ), F) is the dual vector space of H n−d−1 ( F <t ), i.e.,
the linear maps to F. Recall that

614

D. Attali et al. / Computational Geometry 48 (2015) 606–621

βd ( X ) = rank H d ( X ) + 1 if d = 0,
0

otherwise.

We thus have

βd ( F ≥t ) = βn−d−1 ( F <t ) +

if d = 0,
−1 if d = n − 1,

1
0

(4)

otherwise.

By combining Eqs. (3) and (4), we obtain the stated equality.
For all piecewise linear functions f , g on Sn with
Lemmas 1 and 5,

✷

g − f ∞ ≤ δ and t ± δ ∈ int(im f ), we have t ∈ int(im g ) and thus by

β(G t ) ≥ β( F ≤t −δ → F ≤t +δ ) + β( F <t −δ → F <t +δ ).
This motivates the following deﬁnition:
Deﬁnition 3. Let f , g be piecewise linear functions on Sn and consider real parameters t and δ with t ± δ ∈ int(im f ). The
function g is called a level set (t , δ)-reconstruction of f if g − f ∞ ≤ δ and

β(G t ) = β( F ≤t −δ → F ≤t +δ ) + β( F <t −δ → F <t +δ ).
A level set (t , δ)-reconstruction is thus also a minimizer of β(G t ) subject to
only be achieved if both inequalities

g − f ∞ ≤ δ . Since the above equality can

β(G ≤t ) ≥ β( F ≤t −δ → F ≤t +δ ) and
β(G <t ) ≥ β( F <t −δ → F <t +δ )
derived from Lemma 1 hold with equality, we conclude:
Lemma 6. Let f , g be piecewise linear functions on Sn . If g is a level set (t , δ)-reconstruction of f , then

β(G ≤t ) = β( F ≤t −δ → F ≤t +δ )
β(G <t ) = β( F <t −δ → F <t +δ )
and in particular g is also a sublevel set (t , δ)-reconstruction of f .
We will show in the following that sublevel set reconstructions are also level set reconstructions, under some additional
hypotheses.
3.3. Level set reconstruction is NP-hard
Deﬁnition 4. Let f be a piecewise linear function. A homological regular value of f is a number t ∈ R such that
H ∗ ( F <t → F ≤t ) is an isomorphism.
We remark that there exist several other notions of regularity in the literature, which do not match our deﬁnition when
extended to general functions [8,20]. For piecewise linear functions however, all these deﬁnitions are equivalent. Note also
that regularity should be understood with respect to sublevel sets; t can be a regular value t even though H ∗ ( F >t → F ≥t )
might not be an isomorphism.
Lemma 7. Let f be a piecewise linear function on Sn , n > 1. If t ± δ ∈ int(im f ) are regular values of f and g is a level set
(t , δ)-reconstruction of f , then t is a regular value of g.
Proof. By hypothesis t ± δ are regular values of f , so

H ∗ ( F <t −δ → F ≤t −δ )

and

H ∗ ( F <t +δ → F ≤t +δ )

are isomorphisms and

β( F <t −δ → F <t +δ ) = β( F <t −δ → F ≤t +δ ) = β( F ≤t −δ → F ≤t +δ ).
Since g is a level set (t , δ)-reconstruction of f , by Lemma 6, we have

D. Attali et al. / Computational Geometry 48 (2015) 606–621

615

β(G ≤t ) = β( F ≤t −δ → F ≤t +δ ) and
β(G <t ) = β( F <t −δ → F <t +δ )
and hence

β(G ≤t ) = β(G <t ) = β( F <t −δ → F ≤t +δ ).
Observing that

F <t −δ ⊂ G <t ⊂ G ≤t ⊂ G ≤t +δ
and using the fact that whenever we have three linear maps

U →V →W →X
between ﬁnite-dimensional vector spaces, then

rank(U → X ) ≤ rank( V → W ),
we get

β( F <t −δ → F ≤t +δ ) ≤ β(G <t → G ≤t ) ≤ β(G ≤t ).
Combining all these relations, we deduce that

β(G ≤t ) = β(G <t ) = β(G <t → G ≤t ) = β(G ≤t )
and conclude that H ∗ (G <t → G ≤t ) is an isomorphism.

✷

Lemma 8. Let f and g be piecewise linear functions on Sn , n > 1. Assume that t ± δ ∈ int(im f ) are regular values of f and t ∈
int(im g ) is a regular value of g. Then g is a sublevel set (t , δ)-reconstruction of f if and only if g is a level set (t , δ)-reconstruction
of f .
Proof. By hypothesis, t is a regular value of g. Substituting into Lemma 5, we obtain the ﬁrst equation below; the second
equation comes from the fact that t ± δ are regular values of f :

2β(G ≤t ) = β(G t ),
2β( F ≤t −δ → F ≤t +δ ) = β( F ≤t −δ → F ≤t +δ ) + β( F <t −δ → F <t +δ ).
By deﬁnition, g is a sublevel set (t , δ)-reconstruction of f if and only if the left hand sides of the two equations above are
equal. Similarly, g is a level set (t , δ)-reconstruction if and only if the right hand sides of the two equations above are equal.
The result follows immediately. ✷
Theorem 4. The level set reconstruction problem is NP-hard: Given as input a simplexwise linear function on a triangulation of S3 and
parameters t and δ , decide whether there exists a level set (t , δ)-reconstruction g of f . The problem is NP-complete if g is required to
be simplexwise linear on this triangulation.
Proof. We reuse the same reduction as in Theorem 2. Since we need functions deﬁned on the sphere, we triangulate the
complement of K to obtain a triangulation S of the sphere with size polynomial in the size of K and K ⊂ S as in Lemma 4.
We extend f from Eq. (1) to a simplexwise linear function ˜f on sd S:

˜f : σ →

f (σ )
2

if σ ∈ K ,
otherwise.

We then prove that propositions (a)–(e) in the proofs of Theorems 1 and 2 and (f), (g) below are equivalent.
(f) ˜f has a simplexwise linear level set (0, 1)-reconstruction g˜ .
(g) ˜f has a level set (0, 1)-reconstruction g˜ .
We trivially have (f) ⇒ (g). Now we prove that (g) ⇒ (d). Proposition 1 implies that the values ±1 are regular values of
˜f . By Lemma 7, the value 0 is a regular value of g˜ . Lemma 8 then proves that g˜ is a sublevel set reconstruction of ˜f . Now
let g be the restriction of g˜ to K . Since the sublevel sets F ≤t and F ≤t are homotopy equivalent for t ≤ 1, and the sublevel
sets G ≤t and G ≤t are homotopy equivalent for t ≤ 0, it follows that g is a sublevel set reconstruction of f .
Next, we prove that (c) ⇒ (f). Given a subcomplex reconstruction X of ( K , L ), we deﬁne g using Eq. (2) and extend it
to g˜ : sd S → R as above for ˜f . Since 0 is a regular value of g˜ , Lemma 8 implies that g˜ is a level set reconstruction.
In analogy to the proof of Theorem 2, we obtain NP-hardness of the level set reconstruction problem and NPcompleteness of the problem restricted to simplexwise linear functions. ✷

616

D. Attali et al. / Computational Geometry 48 (2015) 606–621

Corollary 3. The level set simpliﬁcation problem is NP-hard: Given a piecewise linear function f on S3 and parameters t and δ , ﬁnd a
simplexwise linear function g minimizing β(G t ) subject to g − f ∞ ≤ δ .
Proof. To determine if f has a level set (t , δ)-reconstruction, we can ﬁrst ﬁnd a minimizer of β(G t ). We then only need to
check if β(G t ) matches the lower bound

β(G t ) = β(G ≤t ) + β(G <t ) ≤ β( F ≤t −δ → F ≤t +δ ) + β( F <t −δ → F <t +δ ),
which can be done in time polynomial in the size of the underlying triangulation.

✷

4. Realizations of well groups
We now discuss how the previous results relate to the concept of well groups, which were introduced in [12] as a robust
version of the homology group of a level set.
Let f : K → R be a piecewise linear function. For δ ≥ 0 and an interval [a, b] ⊂ R, the ([a, b], δ)-well group of f is deﬁned
as

W ∗ f , [a, b], δ =

im H ∗ (G [a,b] → F [a−δ,b+δ] ),
g : g − f ∞ ≤δ

where F [a,b] = f −1 ([a, b]). In fact, as shown in [13], the well group is already given by the intersection of just two persistent
homology groups:

W ∗ f , [a, b], δ = im H ∗ ( F [a−δ,b−δ] → F [a−δ,b+δ] )

∩ im H ∗ ( F [a+δ,b+δ] → F [a−δ,b+δ] ).

(5)

The following formula expresses the rank of the well group in terms of persistent Betti numbers using relative homology.
Theorem 5. (See Bendich et al. [13].) Let f : K → R be a piecewise linear function and let a ≤ b and δ ∈ R be such that a ± δ, b ± δ
are regular values of f . Then

rank W ∗ f , [a, b], δ = β( F ≤b−δ → F ≤b+δ )

− β ( F ≤b−δ , ∅) → (K, F ≥a+δ )
+ β (K, F ≥a+δ ) → (K, F ≥a−δ )
− β ( F ≤b+δ , ∅) → (K, F ≥a−δ ) .
We are particularly interested in the case where the interval consists of a single point. We call W ∗ ( f , t , δ) =
W ∗ ( f , [t , t ], δ) the (t , δ)-well group of f . Intuitively, it captures the homology common to all perturbed level sets.
Clearly, the rank of the well group provides a lower bound on the Betti number of the t-level set of any g with
g − f ∞ ≤ δ:

β(G t ) ≥ β(G t → F [t −δ,t +δ] ) ≥ rank W ∗ ( f , t , δ).
We say that the well group is realized by such a function g if

β(G t ) = rank W ∗ ( f , t , δ),
or equivalently, if H ∗ (G t → F [t −δ,t +δ] ) maps H ∗ (G t ) bijectively to W ∗ ( f , t , δ). As we will show in Theorem 6, this lower
bound cannot always be achieved, and hence not every well group is realizable.
4.1. Realizability of well groups is NP-hard
We now show that on Sn , a realization of a well group is the same as a level set reconstruction:
Theorem 6. Let f be a piecewise linear function on Sn with t ± δ ∈ int(im f ). A piecewise linear function g realizes the well group
W ∗ ( f , t , δ) if and only if it is a level set (t , δ)-reconstruction of f .
Proof. The number of critical values of f is ﬁnite, and so for every s ∈ R, there is
and in (s, s + ] are regular, and hence

H ∗ ( F ≤s− → F <s ) and

H ∗ ( F ≤s → F ≤s+ )

> 0 such that all values in [s − , s)

D. Attali et al. / Computational Geometry 48 (2015) 606–621

617

are isomorphisms. Choose such that the above holds for s = t ± δ . Let a = t − and b = t + . Now a ± δ, b ± δ are regular
values and we can apply Theorem 5.
The second and forth terms in the formula of Theorem 5 vanish. To see this, note that t ± δ ∈ int(im f ) implies

F ≤b±δ = F ≤t + ±δ
for

Sn

small enough, and thus βn ( F ≤b±δ ) = 0. Similarly,

F ≥a±δ = F ≥t − ±δ = ∅
and thus β0 (Sn , F ≥a±δ ) = 0. Moreover, βd (Sn ) = 0 for d ∈
/ {0, n}. Since the induced homomorphisms

H ∗ ( F ≤b±δ , ∅) → Sn , F ≥a∓δ
factor as

H ∗ ( F ≤b±δ ) → H ∗ Sn → H ∗ Sn , F ≥a∓δ ,
we have

β ( F ≤b±δ , ∅) → Sn , F ≥a∓δ

= 0.

Moreover, by the duality theorem of extended persistence on manifolds [21], we can rewrite the third term in Theorem 5
as

βd Sn , F ≥a+δ → Sn , F ≥a−δ

= βn−d ( F ≤a−δ → F ≤a+δ ).

Finally, by regularity of the values [a ± δ, t ± δ) and (t ± δ, b ± δ], we have isomorphisms

H ∗ ( F t ±δ → F [a±δ,b±δ] ) and

H ∗ ( F [t −δ,t +δ] → F [a−δ,b+δ] )

and thus by Eq. (5)

W ∗ ( f , t , δ) ∼
= W ∗ f , [a, b], δ .
Altogether, this yields

rank W ∗ ( f , t , δ) = β( F ≤t −δ → F ≤t +δ ) + β( F <t −δ → F <t +δ ).
The statement now follows directly from the deﬁnitions.

✷

Together with Theorem 4, we have:
Corollary 4. The well group realization problem is NP-hard: Given a piecewise linear function f : K ⊆ S3 → R and parameters t and δ ,
decide whether the well group W ∗ ( f , t , δ) can be realized. The problem is NP-complete if the realization is required to be simplexwise
linear on K .
5. An easy case
In this section, we discuss an important special case in which the subcomplex reconstruction problem can in fact be
solved in polynomial time.
5.1. Building a p-reconstruction of an easily p-reconstructible pair
We start by presenting a polynomial time algorithm which outputs a p-reconstruction of the pair ( K , L ), assuming that

( K , L ) is p-reconstructible and enjoys an easiness property that we describe below.
Deﬁnition 5. Given a simplicial complex K and a subcomplex L, we say that ( K , L ) is an easily p-reconstructible pair if
(a) ( K , L ) is p-reconstructible and
(b) for all subcomplexes X such that L ⊆ X ⊆ K , the homomorphism H p −1 ( X → K ) induced by the inclusion X ⊆ K is
injective.

618

D. Attali et al. / Computational Geometry 48 (2015) 606–621

Fig. 7. An easily 1-reconstructible pair ( K , L ) embedded in R2 and a 1-reconstruction obtained after removing from K the ( K , L )-homology generating
edges (bold edges) and their cofaces.

Fig. 8. Commutative diagrams for the proof of Lemma 10. Left: injectivity of i implies injectivity of i . Right: injectivity of φ implies injectivity of φ .

Condition (b) is equivalent to requiring that for every ﬁltration F containing the two simplicial complexes L and K , no
( p − 1)-cycle is destroyed in F between L and K . In other words, each time a p-simplex is added in F between L and K ,
it creates a p-cycle; see Fig. 7. Using the terminology in [7], this means that the ﬁltration F has only positive p-simplices
in K \ L. Note that for condition (b) to hold we only need the positivity of p-simplices in K \ L for one ﬁltration F and not
for every permutation. To see this, recall that given a ﬁltration F there exists a pairing between its positive p-simplices and
negative ( p + 1)-simplices. The analysis in [22] shows that when we swap two consecutive simplices in the ﬁltration, either
they keep their pairings, or they swap them, but in no case can the number of negative p-simplices change. It follows that
we can go from one ﬁltration F containing L and K to any other while preserving the positivity of p-simplices in K \ L.
Hence, checking condition (b) boils down to computing the pairing of p-simplices in F and thus takes polynomial time. In
practice, checking the easiness property will not be necessary, as we shall see below.
We now describe a polynomial time algorithm that constructs a solution to the dimension p reconstruction problem of
the pair ( K , L ), whenever ( K , L ) is easily p-reconstructible. The idea is to remove p-simplices from K in order to “break”
p-cycles in K that do not correspond to cycles in L; see Fig. 7.
We say that a p-simplex σ ∈ K \ L is ( K , L )-homology generating if there is a chain c ∈ C p ( L ) such that ∂ σ = ∂ c and
[σ + c ] K ∈
/ im H p ( L → K ). Clearly, this implies that σ cannot be contained in any homological reconstruction X of ( K , L ),
and hence the same is also true for every coface of σ . Writing st K σ for the set of cofaces of σ in K , we conclude:
Lemma 9. Let X be a solution to the dimension p reconstruction problem of the pair ( K , L ). For any ( K , L )-homology generating
p-simplex σ , we have st K σ ⊆ K \ X .
This lemma suggests the following algorithm for computing a p-reconstruction of an easily p-reconstructible pair ( K , L ):
Reconstruction( K , L , p )
K ←K
while ∃ a ( K , L )-homology generating p-simplex
remove st K σ from K

σ

endwhile
return K
We now show correctness of the algorithm.
Lemma 10. Suppose ( K , L ) is an easily p-reconstructible pair. For any ( K , L )-homology generating p-simplex σ , the pair ( K , L ),
where K = K \ st K σ , is an easily p-reconstructible pair. Moreover, every p-reconstruction of ( K , L ) is also a p-reconstruction of
( K , L ).
Proof. Let K = K \ st K σ . Let X be a solution to the dimension p reconstruction problem of the pair ( K , L ). By Lemma 9,
we have L ⊆ X ⊆ K . Consider the commutative diagram of Fig. 8 (left) where all maps are induced by inclusions. Since X
is a p-reconstruction of the pair ( K , L ), i is injective and j is surjective. Since i = ϕ ◦ i , the map i is also injective and thus
im(i ◦ j ) ∼
= H p ( X ), showing that X is also a p-reconstruction of the pair ( K , L ).
We now use the easiness of the pair ( K , L ) to prove the easiness of the pair ( K , L ). Consider an arbitrary simplicial
complex X such that L ⊆ X ⊆ K and the commutative diagram of Fig. 8 (right) where all maps are induced by inclusions.
Since φ = ψ ◦ φ , the injectivity of φ implies the injectivity of φ . ✷

D. Attali et al. / Computational Geometry 48 (2015) 606–621

619

Suppose ( K , L ) is an easily p-reconstructible pair. From Lemma 10, it follows that at each step of the reconstruction
algorithm, ( K , L ) is also an easily p-reconstructible pair. If H p ( K ) ∼
= im H p ( L → K ), we claim that we can always ﬁnd a
( K , L )-homology generating p-simplex σ . Indeed, by assumption, every p-simplex σ in K \ L is positive for every ﬁltration
F containing L and K . This implies that ∂ σ is the boundary of some p-chain c ∈ C p ( L ) for every p-simplex σ in K \ L.
The classes [σ + c ] K , where σ is a p-simplex in K \ L, together with im H p ( L → K ), generate H p ( K ). Since H p ( K ) ∼
=
im H p ( L → K ), there must be a σ such that [σ + c ] K ∈
/ im H p ( L → K ). Both ﬁnding a c for a given σ and deciding
whether [σ + c ] K ∈ im H p ( L → K ) can be done in time polynomial in the size of K .
The size of K decreases strictly during the course of the algorithm. Since K is ﬁnite, the algorithm has to stop eventually,
and when it stops, we have H p ( K ) ∼
= im H p ( L → K ) ∼
= im H p ( L → K ).
In practice, we need not test whether or not the pair ( K , L ) satisﬁes the easiness property. It suﬃces to run the algorithm
and check if the resulting complex K is a p-reconstruction. If the pair ( K , L ) is not easily p-reconstructible (as in Fig. 1),
the algorithm will output a simplicial complex X nested between L and K whose p-dimensional Betti number will differ
from the persistent Betti number β p ( L → K ). Nonetheless, if ( K , L ) has any p-reconstruction, it must be a subset of K , and
the algorithm may occasionally output a reconstruction even for pairs ( K , L ) that do not enjoy the easiness property.
5.2. Reconstruction in 3D
First, we review the use of persistent homology groups for homological inference, as proposed in [8,10]. Second, we
formulate the problem of reconstructing a 3D shape as one of ﬁnding a subcomplex reconstruction of a simplicial pair
which enjoys the property to be easily 1-reconstructible. Assuming a solution exists, we then describe how to build it in
polynomial time. We use the notation Ω α = {x ∈ Rn : d(x, Ω) ≤ α }.
Deﬁnition 6. Let Ω ⊂ Rn and let S ⊂ Rn be ﬁnite. We say that S is a homological (δ, )-sample of Ω if Ω ⊆ S δ , S ⊆ Ω , and
both

H ∗ Ω → Ω δ+

and

H ∗ Ω δ+ → Ω 2δ+2

are isomorphisms.
Roughly, δ is a bound on the sampling density, and is a bound on the sampling error. If S is a homological (δ, )-sample
of Ω , then the plain arrows in the following diagram commute:

Moreover, there exists a unique isomorphism H ∗ (Ω δ+ ) → im H ∗ ( S δ → S 2δ+ ) such that the full diagram commutes. Hence,
im H ∗ ( S δ → S 2δ+ ) ∼
= H ∗ (Ω).
Given as input a point set S that samples Ω , we are thus able to infer the homology groups of Ω from S by computing
the persistent homology groups of the pair ( S 2δ+ , S δ ). Moreover we have the following lemma:
Lemma 11. Let S be a homological (δ, )-sample of Ω ⊂ Rn with δ ≥ . Then H 0 ( S δ → S 2δ+ ) is an isomorphism.
Proof. First, note that H 0 ( S δ → S 2δ+ ) is surjective, since every component of S 2δ+ contains a point of S ⊂ S δ . It remains
to prove that H 0 ( S δ → S 2δ+ ) is injective.
We ﬁrst show that H 0 (Ω → S δ ) is surjective. Let x ∈ S δ . There is s ∈ S with d(x, s) ≤ δ . Moreover, there is y ∈ Ω with
d(s, y ) ≤ . Since ≤ δ , the two points x and y are both contained in the ball of radius δ around s and hence in the same
connected component of S δ . In other words, every connected component of S δ contains a point of Ω , so H 0 (Ω → S δ ) is
surjective.
Since H 0 (Ω → Ω δ+ ) is an isomorphism, this implies that H 0 ( S δ → Ω δ+ ) must be injective. By injectivity of
H 0 (Ω δ+ → S 2δ+ ), we obtain that H 0 ( S δ → S 2δ+ ) is injective. ✷
In practice, we replace each S α in the pair by the corresponding

α -complex of S which can be computed eﬃciently in

R3 using the Delaunay triangulation. We recall that the Delaunay triangulation is the set of simplices σ ⊂ S for which there
exists a ball whose boundary contains the vertices of

σ and which encloses no point of S in its interior. Such a ball is said

620

D. Attali et al. / Computational Geometry 48 (2015) 606–621

Fig. 9. Top: A pair ( K , L ) embedded in Rn and its (n − 1)-reconstruction for n = 2. Bottom from left to right: graph G whose edges correspond to
(n − 1)-simplices of K and subgraph G whose (bold) edges correspond to (n − 1)-simplices of K \ L. Paths joining connected components of Rn \ K in G .
Applying simplicial collapses along a path to merge two connected components.

to be empty. The α -complex, denoted A α ( S ), is the subcomplex of the Delaunay triangulation obtained by keeping simplices
that ﬁt in an empty ball of radius α or less. It is a deformation retraction of the offset S α .
We now focus our attention on the case n = 3 and δ ≥ . It turns out that in this case we can ﬁnd a subcomplex
reconstruction of the pair of α -complexes ( K , L ) = (A2δ+ ( S ), Aδ ( S )) in polynomial time, if one exists. Note that for each
α ≥ 0, the offset S α deformation retracts to Aα ( S ), and the pair ( S 2δ+ , S δ ) has a subspace reconstruction Ω δ+ . Note
however that this does not imply that ( K , L ) has a (subcomplex or subspace) reconstruction. From now on, we assume that
a subcomplex reconstruction of ( K , L ) exists. We next describe how to ﬁnd one under this assumption.
Since H 0 ( L → K ) is an isomorphism by Lemma 11 and since there are no new vertices in K \ L, this implies that every
complex nested between L and K is a 0-reconstruction. Moreover, no edge in K \ L joins two connected components of L;
in other words, ( K , L ) is easily 1-reconstructible. Construct a 1-reconstruction K as described above. Recall that this takes
time polynomial in the size of K .
By Alexander duality, the ﬁnite connected components of the complement R3 \ K correspond to classes in H 2 ( K ).
Hence, K is a 2-reconstruction of ( K , L ) if and only if any two components of R3 \ K that lie in the same component
of R3 \ L are also contained in the same component of R3 \ K (see Fig. 9 for an analogous illustration in R2 ). We note
that such a 2-reconstruction of ( K , L ) is also a 2-reconstruction of ( K , L ) because H 2 ( K → K ) is injective as cavities in
K cannot be destroyed in K by construction of K . In order to obtain a 2-reconstruction K , we now remove simplices of
dimension 2 and 3 from K in order to connect all components in R3 \ K that are in the same component of R3 \ L.
Consider the dual graph G of K , whose vertices are the tetrahedra of K together with the connected components
of R3 \ K , and whose edges correspond to the triangles of K ; see Fig. 9. Let G be the subgraph of G whose edges
correspond to triangles in K \ L. Now two components of R3 \ K lie in the same component of R3 \ L if and only if they
are connected by a path in G . Removing the corresponding triangles and tetrahedra from K merges the two components
of the complement R3 \ K . Repeating this procedure while there are mergeable components, we obtain a complex K with
H2(K ) ∼
= im H 2 ( L → K ). The construction of K can also be done in polynomial time.
Note that this procedure will not affect the property that the resulting complex K is a 1-reconstruction: two components in the complement of K can be merged in the complement of K by a sequence of simplicial collapses on K ,
followed by the removal of a 2-simplex of K with empty coboundary; see Fig. 9, bottom. This triangle must be positive,
since its removal merges two components of the complement. In other words, its removal will not destroy any 1-cycle in
the 1-reconstruction. The resulting complex K is thus a reconstruction of ( K , L ). We conclude:
Theorem 7. Let S be a homological (δ, )-sample of Ω ⊂ R3 with δ ≥ . Then the subcomplex reconstruction problem for the pair of
α -complexes (A2δ+ ( S ), Aδ ( S )) can be solved in polynomial time. If a reconstruction exists, its homology is isomorphic to that of Ω .
6. Conclusion
The homological reconstruction problem of simplicial pairs embedded in R3 is NP-hard. It is also NP-hard to decide
whether a real-valued simplexwise linear function in R3 has a level set or a sublevel set reconstruction. We deduce that
simplifying the homology of a simplicial pair embedded in R3 is also NP-hard, and so is the homological simpliﬁcation
of level and sublevel sets of real-valued simplexwise linear functions in R3 . On the other hand, such problems can be
solved in polynomial time if we restrict ourselves to pairs of α -complexes in R3 that admit homological inference of a
compact space, given an appropriate sample. Can we use this construction to devise a shape reconstruction algorithm with
homological guarantees under the same sampling conditions?

D. Attali et al. / Computational Geometry 48 (2015) 606–621

621

Acknowledgements
This work was initiated during the 10th McGill–INRIA Workshop on Computational Geometry at the Bellairs Research
Institute. The authors wish to thank all the participants for creating a pleasant and stimulating atmosphere, in particular
Nina Amenta for discussions leading to a ﬁrst version of Theorem 1. Some of the authors were partially supported by
the ANR project TopData ANR-13-BS01-0008, the European project CG-Learning (contract 255827), and the Toposys project
FP7-ICT-318493-STREP.
References
[1] H. Edelsbrunner, Alpha shapes – a survey, in: R. van de Weygaert, G. Vegter, J. Ritzerveld, V. Icke (Eds.), Tessellations in the Sciences: Virtues, Techniques
and Applications of Geometric Tilings, Springer Verlag, in press.
[2] V. de Silva, G. Carlsson, Topological estimation using witness complexes, in: Eurographics Symposium on Point-Based Graphics, 2004, pp. 157–166.
[3] P. Niyogi, S. Smale, S. Weinberger, Finding the homology of submanifolds with high conﬁdence from random samples, Discrete Comput. Geom. 39 (1–3)
(2008) 419–441, http://dx.doi.org/10.1007/s00454-008-9053-2.
[4] F. Chazal, A. Lieutier, Smooth manifold reconstruction from noisy and non-uniform approximation with guarantees, Comput. Geom. 40 (2) (2008)
156–170, http://dx.doi.org/10.1016/j.comgeo.2007.07.001.
[5] F. Chazal, D. Cohen-Steiner, A. Lieutier, A sampling theory for compact sets in Euclidean space, Discrete Comput. Geom. 41 (3) (2009) 461–479,
http://dx.doi.org/10.1007/s00454-009-9144-8.
[6] D. Attali, A. Lieutier, D. Salinas, Vietoris–Rips complexes also provide topologically correct reconstructions of sampled shapes, Comput. Geom. 46 (4)
(2013) 448–465, http://dx.doi.org/10.1016/j.comgeo.2012.02.009.
[7] H. Edelsbrunner, D. Letscher, A. Zomorodian, Topological persistence and simpliﬁcation, Discrete Comput. Geom. 28 (4) (2002) 511–533,
http://dx.doi.org/10.1007/s00454-002-2885-2.
[8] D. Cohen-Steiner, H. Edelsbrunner, J. Harer, Stability of persistence diagrams, Discrete Comput. Geom. 37 (1) (2007) 103–120, http://dx.doi.org/
10.1007/s00454-006-1276-5.
[9] F. Chazal, V. de Silva, M. Glisse, S. Oudot, The structure and stability of persistence modules, preprint, arXiv:1207.3674, 2012.
[10] F. Chazal, A. Lieutier, Stability and computation of topological invariants of solids in Rn , Discrete Comput. Geom. 37 (4) (2007) 601–617,
http://dx.doi.org/10.1007/s00454-007-1309-8.
[11] D. Attali, A. Lieutier, Optimal reconstruction might be hard, Discrete Comput. Geom. 49 (2) (2013) 133–156, http://dx.doi.org/10.1007/
s00454-012-9475-8.
[12] H. Edelsbrunner, D. Morozov, A. Patel, Quantifying transversality by measuring the robustness of intersections, Found. Comput. Math. 11 (3) (2011)
345–361, http://dx.doi.org/10.1007/s10208-011-9090-8.
[13] P. Bendich, H. Edelsbrunner, D. Morozov, A. Patel, Homology and robustness of level and interlevel sets, Homol. Homotopy Appl. 15 (1) (2013) 51–72,
http://dx.doi.org/10.4310/HHA.2013.v15.n1.a3.
[14] A. Hatcher, Algebraic Topology, Cambridge University Press, 2002.
´ D. Morozov, P. Skraba, Zigzag persistent homology in matrix multiplication time, in: Proceedings of the Twenty-Seventh Annual
[15] N. Milosavljevic,
Symposium on Computational Geometry, SoCG ’11, ACM, New York, NY, USA, 2011, pp. 216–225.
[16] W. Kühnel, Triangulations of manifolds with few vertices, in: F. Tricerri (Ed.), Advances in Differential Geometry and Topology, World Scientiﬁc, Singapore, 1990, pp. 59–114.
[17] D. Morozov, Homological illusions of persistence and stability, Ph.D. thesis, Duke University, Aug. 2008.
[18] E.H. Spanier, Algebraic Topology, Springer, 1994.
[19] H. Edelsbrunner, M. Kerber, Alexander duality for functions: the persistent behavior of land and water and shore, in: Proceedings of the 2012 Symposium on Computational Geometry, ACM, New York, NY, USA, 2012, pp. 249–258.
[20] P. Bubenik, J. Scott, Categoriﬁcation of persistent homology, Discrete Comput. Geom. 51 (2014) 600–627, http://dx.doi.org/10.1007/s00454-014-9573-x.
[21] D. Cohen-Steiner, H. Edelsbrunner, J. Harer, Extending persistence using Poincaré and Lefschetz duality, Found. Comput. Math. 9 (1) (2008) 79–103,
http://dx.doi.org/10.1007/s10208-008-9027-z.
[22] D. Cohen-Steiner, H. Edelsbrunner, D. Morozov, Vines and vineyards by updating persistence in linear time, in: Proceedings of the Twenty-Second
Annual Symposium on Computational Geometry, SCG ’06, ACM, New York, NY, USA, 2006, pp. 119–126.

