Computational Geometry 48 (2015) 622–633

Contents lists available at ScienceDirect

Computational Geometry: Theory and
Applications
www.elsevier.com/locate/comgeo

Bichromatic compatible matchings
Greg Aloupis a,1 , Luis Barba a,b,∗ , Stefan Langerman a,2 , Diane L. Souvaine c,3
a
b
c

Département d’Informatique, Université Libre de Bruxelles, Brussels, Belgium
School of Computer Science, Carleton University, Ottawa, Canada
Department of Computer Science, Tufts University, Medford, MA, United States

a r t i c l e

i n f o

Article history:
Available online 26 August 2014
Keywords:
Perfect matchings
Bichromatic point set
Compatible matchings
Transformation graph
Reconﬁguration problem

a b s t r a c t
For a set R of n red points and a set B of n blue points, a BR-matching is a non-crossing
geometric perfect matching where each segment has one endpoint in B and one in R.
Two BR-matchings are compatible if their union is also non-crossing. We prove that, for
any two distinct BR-matchings M and M , there exists a sequence of BR-matchings M =
M 1 , . . . , M k = M such that M i −1 is compatible with M i . This implies the connectivity of
the compatible bichromatic matching graph containing one node for each BR-matching and an
edge joining each pair of compatible BR-matchings, thereby answering the open problem
posed by Aichholzer et al. in [1].
© 2014 Elsevier B.V. All rights reserved.

1. Introduction
A planar straight line graph (PSLG) is a geometric graph in which the vertices are points embedded in the plane and
the edges are non-crossing line segments. There are many special types of PSLGs of which we name a few. A triangulation
is a PSLG to which no more edges may be added between existing vertices. A geometric matching of a given point set P
is a 1-regular PSLG consisting of pairwise disjoint line segments in the plane joining points of P . A geometric matching is
perfect if every point in P belongs to exactly one segment.
Two branches of study on PSLGs include those of geometric augmentation and geometric reconﬁguration. A typical
augmentation problem on a PSLG G = ( V , E ) asks for a set of new edges E such that the graph ( V , E ∪ E ) retains or gains
some desired properties (see survey by Hurtado and Tóth [2]).
A typical reconﬁguration problem on a pair of PSLGs G and G sharing some property asks for a sequence of PSLGs
G = G 0 , . . . , G k = G where each successive pair of PSLGs G i −1 , G i jointly satisﬁes some geometric constraints. In some
situations, a bound on the value of k is desired as well [3–9].
One such solved problem is that of reconﬁguring triangulations: given two triangulations T and T , one can compute a
sequence of triangulations T = T 0 , . . . , T k = T on the same point set such that T i −1 can be reconﬁgured to T i by ﬂipping
one edge. Furthermore, bounds on the value of k are known: O (n2 ) edge ﬂips are always suﬃcient [8] and Ω(n2 ) edge ﬂips
are sometimes necessary [7].

*
1
2
3

Corresponding author.
E-mail addresses: aloupis.greg@gmail.com (G. Aloupis), lbarbaﬂ@ulb.ac.be (L. Barba), slanger@ulb.ac.be (S. Langerman), dls@cs.tufts.edu (D.L. Souvaine).
Chargé de recherches du F.R.S.-FNRS.
Directeur de recherches du F.R.S.-FNRS.
Supported by NSF Grant #CCF-0830734.

http://dx.doi.org/10.1016/j.comgeo.2014.08.009
0925-7721/© 2014 Elsevier B.V. All rights reserved.

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

623

Fig. 1. A ham-sandwich matching obtained by recursively applying ham-sandwich cuts.

Two PSLGs (not necessarily disjoint) on the same vertex set are compatible if their union is planar. Compatible geometric
matchings have been the object of study in both augmentation and reconﬁguration problems. For example, the Disjoint
Compatible Matching Conjecture [5] was recently solved in the aﬃrmative [10]: every perfect planar matching M of 2n
segments on 4n points can be augmented by 2n additional segments to form a PSLG that is the union of simple polygons.
Let M and M be two perfect planar matchings of a given point set. The reconﬁguration problem asks for a compatible
sequence of perfect matchings M = M 0 , . . . , M k = M such that M i −1 is compatible with M i for all i ∈ {1, . . . , k}. Aichholzer
et al. [5] proved that there is always a compatible sequence of O (log n) matchings that reconﬁgures any given matching into
a canonical matching. Thus, the compatible matching graph, that has one node for each perfect planar matching and an edge
between any two compatible matchings, is connected with diameter O (log n). Razen [9] proved that the distance between
two nodes in this graph is sometimes Ω(log n/ log log n).
A natural question to extend this research is to ask what happens with bichromatic point sets in which the segments
must join points from different colors. Let P = B ∪ R be a set of points in the plane in general position where | R | = | B | = n.
A straight-line segment with one endpoint in B and one in R is called a bichromatic segment. A perfect planar matching of P
where every segment is bichromatic is called a BR-matching. Sharir and Welzl [11] proved that the number of BR-matchings
of P is at most O (7.61n ). Hurtado et al. [12] showed that any BR-matching can be augmented to a crossing-free bichromatic
1
spanning tree in O (n log n) time. Aichholzer et al. [1] proved that for any BR-matching M of P , there are at least n−
2
bichromatic segments spanned by P that are compatible with M. Furthermore, there are BR-matchings with at most 3n/4
compatible bichromatic segments.
At least one BR-matching can always be produced by recursively applying ham-sandwich cuts; see Fig. 1 for an illustration.
A BR-matching produced in this way is called a ham-sandwich matching. Notice that the general position assumption is
sometimes necessary to guarantee the existence of a BR-matching. However, not all BR-matchings can be produced using
ham-sandwich cuts. Furthermore, some point sets admit only one BR-matching, which must be a ham-sandwich matching.
Two BR-matchings M and M are connected if there is a sequence of BR-matchings M = M 0 , . . . , M k = M , such that M i −1
is compatible with M i , for 1 ≤ i ≤ k. An open problem posed by Aichholzer et al. [1] was to prove that all BR-matchings of
a given point set are connected.4 We answer this in the aﬃrmative by using a ham-sandwich matching H as a canonical
form. Consider the ﬁrst ham-sandwich cut line used to construct H . We show how to reconﬁgure any given BR-matching
via a compatible sequence so that the last matching in the sequence contains no segment crossing . We use this result
recursively, on every ham-sandwich cut used to generate H , to show that any given BR-matching is connected with H .
2. Ham-sandwich matchings
In this paper, a ham-sandwich cut of P is a line passing through no point of P and containing exactly n2 blue and
red points to one side. Notice that if n is even, then this matches the classical deﬁnition of ham-sandwich cuts (see
Chapter 3 of [13]). However, when n is odd, a ham-sandwich cut according to the classical deﬁnition will go through a
red and a blue point of P . In this case, we obtain a ham-sandwich cut according to our deﬁnition by slightly moving
away from these two points without changing its slope and without reaching another point of P . By the general position
assumption, this is always possible.
Recall that P admits at least one ham-sandwich matching resulting from recursively applying ham-sandwich cuts. Moreover, note that P may admit several ham-sandwich matchings.
Let M be a BR-matching of P . In this section we prove that M is connected with a ham-sandwich matching H of P .
Consider a ham-sandwich cut used to construct H . The idea of the proof is to show the existence of a BR-matching M ,
n
2

4

This problem was also posed during the EuroGIGA meeting that took place after EuroCG 2012.

624

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

compatible with M, such that M has “fewer” crossings with according to some measure deﬁned on BR-matchings. By
repeatedly applying this result, we end up with a matching N, connected with M, such that no segment of N crosses .
Once we know how to avoid a ham-sandwich cut, we can apply the same result recursively on every ham-sandwich cut
used to generate H . In this way, we obtain a sequence of compatible BR-matchings that connect M with H .
The main ingredient to obtain these results is Lemma 2.2 below. Before stating this lemma, we need a few more deﬁnitions.
Given a line that contains no point of P , let M be the set of segments of M that cross . We say that is a chromatic
cut of M if | M | ≥ 2 and not all endpoints of M on one side of have the same color. Without loss of generality, we can
assume that if a chromatic cut exists, then it is vertical and no segment of M is parallel to . The following observation
shows the relation between chromatic and ham-sandwich cuts.
Lemma 2.1. Given any BR-matching M of P , every ham-sandwich cut of P either crosses no segment of M, or is a chromatic cut of M.
Proof. Let be a ham-sandwich cut of M. Recall that the number of blue and red points to the right of must be the
same. Moreover, every segment that is not crossed by has both of its endpoints on one of its sides. Therefore, if crosses
a segment of M having a red endpoint to the right of , then, to maintain the balance of red and blue points, must cross
another segment having a blue endpoint to the right of . That is, is a chromatic cut of M. ✷
We say that a point lies above (resp. below) a segment if it lies above (resp. below) the line extending that segment. We
proceed to state Lemma 2.2. However, its proof is deferred to Section 4 for ease of readability.
Lemma 2.2. Let M be a BR-matching of P and let be a chromatic cut of M. There exists a BR-matching M of P compatible with M
with the following properties: There is a segment s in M \ M that crosses such that all segments of M that cross below s belong
also to M . Moreover, these are the only segments of M crossing below s.
In other words, Lemma 2.2 states that we can ﬁnd a BR-matching M , compatible with M, such that a segment s from M
that crosses does not appear in M . Moreover, every segment of M that crosses below s is preserved in M , and no new
segment crossing below s is introduced. However, we have no control over what happens above s.
Lemma 2.3. Given a BR-matching M of P and a ham-sandwich cut , there is a BR-matching N connected with M such that no
segment of N crosses .
Proof. Assume that is a chromatic cut of M, i.e., that it crosses at least one segment of M. Otherwise, the result follows
trivially by Lemma 2.1. Given a BR-matching W of P such that is a chromatic cut of W , let Next( W ) be a BR-matching
compatible with W that exists as a consequence of Lemma 2.2 when applied to W .
We construct a sequence ϕ of BR-matchings as follows. Let M 0 = M be the ﬁrst element of ϕ . If is a chromatic cut
of M i , then let M i +1 = Next( M i ). Otherwise, M i has no segment that crosses by Lemma 2.1 and is the ﬁnal element of ϕ .
We claim that ϕ = ( M 0 , M 1 , . . . , M h ) is ﬁnite and hence, that N := M h has no segment that crosses .
Assume without loss of generality that is a vertical line. Let C P = { z0 , z1 , . . . , zm } be the set of all O (n2 ) bichromatic
segments that cross with endpoints in P . Assume that the segments of C P are sorted, from top to bottom, according to
their intersection with . Given a BR-matching W of P , let χ W = bm bm−1 . . . b1 b0 be a binary number where b i is deﬁned
as follows:

bi =

1 if zi belongs to W
0 otherwise

Let M i and M i +1 be two consecutive matchings in ϕ . By Lemma 2.2, there is a segment zk ∈ M i \ M i +1 . Moreover, if z j
is a segment that crosses below zk , then z j ∈ M i if and only if z j ∈ M i +1 . Therefore, the k-th digit of χ M i is 1 while the
k-th digit of χ M i+1 is 0. Moreover, for every j > k, the j-th digit of χ M i is identical to the j-th digit of χ M i+1 . This implies
that χ M i > χ M i+1 . Therefore, Φ = χ M 0 , χ M 1 , . . . , χ Mh is a strictly decreasing sequence. This means that no BR-matching
is repeated and that Φ converges to zero yielding our claim, i.e., we reach a BR-matching containing no segment that
crosses . ✷
Theorem 2.4. Let P = B ∪ R be a set of points in the plane in general position where | R | = | B |. If M is a BR-matching of P and H is a
ham-sandwich matching of P , then M and H are connected, i.e., there is a sequence of BR-matchings M = M 0 , . . . , M r = H such that
M i −1 is compatible with M i for 1 ≤ i ≤ r.
Proof. The proof uses induction on the size of P . Notice that the result follows trivially if | P | = 2 as it contains a unique
BR-matching.
Assume that the result holds for any bichromatic point set with fewer than n points. Let be the ﬁrst ham-sandwich
cut line used to construct H . By Lemma 2.3, there is a matching N such that M and N are connected, and no segment of N

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

625

Fig. 2. (a) Two BR-matchings M and M at distance Ω(n) in the graph G P that are both ham-sandwich matchings. (b) The only two segments compatible
with M are the topmost and bottommost segments of M . Blue points are represented by squares. (For interpretation of the references to color in this
ﬁgure, the reader is referred to the web version of this article.)

crosses . Let Π1 and Π2 be the two halfplanes supported by . For i ∈ {1, 2}, let P i be the set of points of P that lie in Πi
and let N i and H i be, respectively, the set of segments of N and H that are contained in Πi . Because | P i | < | P |, N i and H i
are connected by the induction hypothesis.
Since every BR-matching of P 1 is compatible with every BR-matching of P 2 , we can merge the two compatible sequences obtained by the recursive construction that certify that N i and H i are connected. Thus, N is connected with H and
because M is connected to N, M and H are also connected. ✷
Let V be the set of all BR-matchings of P and let G P be the compatible bichromatic matching graph of P with vertex set V ,
where there is an edge between two vertices if their corresponding BR-matchings are compatible.
Corollary 2.5. Given a set of points P = B ∪ R in general position such that | R | = | B | = n, the graph G P is connected.
While Theorem 2.4 implies the connectedness of G P , it does not provide a non-trivial upper bound on its diameter. Since
Sharir and Welzl [11] proved that the number of vertices in G P is at most O (7.61n ), we obtain an exponential upper bound
on its diameter. Lemma 2.6 below, depicted in Fig. 2, shows a linear lower bound on the diameter of G P .
Lemma 2.6. There exists a bichromatic set P = B ∪ R of 4n points that admits two BR-matchings at distance Ω(n) in G P .
Proof. Let P be the set of vertices of a regular 4n-gon Q . Partition P into four disjoint sets P 0 , . . . , P 3 , each of n consecutive
points along the boundary of Q . Assume without loss of generality that the unique edge on the boundary of Q joining a
point from P 3 with a point in P 0 is parallel to the x-axis. Moreover, assume that this edge is the topmost edge of Q . Let
B = P 0 ∪ P 2 and let R = P 1 ∪ P 3 . Note that for any 0 ≤ i ≤ 3, both bichromatic point sets P i ∪ P i +1 and P i ∪ P i −1 have
unique BR-matchings where sum is taken modulo 3; see Fig. 2(a).
Let M be the union of the unique BR-matchings of P 0 ∪ P 1 and P 2 ∪ P 3 . Analogously, let M be the union of the
BR-matchings of P 1 ∪ P 2 and P 0 ∪ P 3 ; see Fig. 2(a) for an illustration. Let p be a point of P and let M ( p ) and M ( p ) be the
points matched with p in M and M , respectively. We claim that in any BR-matching W of P , the point p is matched with
either M ( p ) or M ( p ). If this is not the case, then the segment s joining p with its neighbor in W separates P into two
sets, each of them having an unbalanced number of blue and red points—a contradiction as the points on each side of s
support a BR-matching that does not cross s.
Let s1 , . . . sn be the last n segments of M when sorted from left to right. We claim that to connect M with a BR-matching
that does not contain si , we need a compatible sequence of BR-matchings of length at least i. The proof uses induction on i.
For the base case, note that only the topmost and bottommost segments of M are compatible with M, any other
bichromatic segment that could be part of a BR-matching either crosses an edge of M or splits P into two unbalanced
sets. By adding these two edges and removing the segments of M that form a cycle with them, we obtain the unique
BR-matching compatible with M where s1 is not present; see Fig. 2(b)
Assume that the result holds for any j < i. Let p be an endpoint of si and note that the segment connecting p with M ( p )
crosses si −1 . That is, p is matched through si in any BR-matching that contains si −1 . Consequently, to reach a BR-matching
where si is not present, we need to ﬁrst remove si −1 , which requires at least i − 1 steps by the induction hypothesis,
and then at least one step more to remove si . Therefore, a sequence of length at least i is needed to connect M with a
BR-matching that does not contain si .
Thus, to connect M with M where sn is not present, we need a compatible sequence of Ω(n) BR-matchings. ✷

626

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

Fig. 3. The coloring of the segments of a well-colored PSLG, as well as of a bichromatic segment. The point y is blue when viewed from x but red when
viewed from z. Moreover, y and z are color-visible. Blue points are represented by squares. (For interpretation of the references to color in this ﬁgure, the
reader is referred to the web version of this article.)

3. Well-colored graphs and basic tools
In this section, we introduce some tools that will help us prove Lemma 2.2 in Section 4.
Given a bounded face F of a PSLG, we denote its interior by int( F ) and its boundary by ∂ F . In the remainder, we only
consider bounded faces when we refer to a face of a PSLG. A vertex v is reﬂex in F if there is a non-convex connected
component in the intersection of int( F ) with any disk centered at v. Notice that a vertex can be reﬂex in at most one face
of a PSLG. A vertex of a PSLG is reﬂex if it is reﬂex in one of its bounded faces.
Let F be a face of a given PSLG whose reﬂex vertices are colored either blue or red. We say that F is well-colored if the
sequence of reﬂex vertices along its boundary alternates in color. In the same way, a PSLG is well-colored if all its faces are
well-colored. Since a vertex is reﬂex in at most one face, a well-colored PSLG has an even number of reﬂex vertices.
Let G be a well-colored PSLG. The boundary of G, denoted by ∂ G, is the union of all the edges in G. The interior of G is
the union of the interiors of its faces. Let M be a BR-matching such that all segments of M are contained in the interior
of G, i.e., no segment of M crosses an edge of G or lies on the boundary of G. We show how to glue the segments of M
to G in such a way that every endpoint of M becomes a reﬂex vertex. We then provide a technique to construct a new
BR-matching, compatible with M, by matching the reﬂex vertices of G after the gluing.
3.1. Coloring a PSLG
Throughout, we consider each segment either bichromatic or on ∂ G to have two sides. Moreover, we assign a color,
either red or blue, to each of these sides; see Fig. 3 for an illustration.
Assume that F is a well-colored face of G and let s be a segment along ∂ F . Let π be an open halfplane supported by s.
The side of s facing π has color c if for any y ∈ π , the ﬁrst reﬂex vertex met when walking in a straight line from y to
the midpoint of s, and then counterclockwise along ∂ F has color c. If F contains no reﬂex vertex, then we chose a color c,
either red or blue, and for each segment along ∂ F , we permanently ﬁx the color of each of its sides facing the interior of F
to c. In this case, we use the freedom on the choice of c to guarantee a color scheme that matches our needs.
This coloring scheme can be used for bichromatic segments as well. For r ∈ R and b ∈ B, let s = [r , b] and consider
an open halfplane π supported by s. The side of s facing π is blue if for any y ∈ π the triple y , r , b makes a left turn.
Otherwise, this side is red. Note that s has one side colored red and its opposite side colored blue.
A point on a segment s has color c when viewed from another point z if the side of s facing the halfplane that contains z
supported by s has color c. Therefore, the color of a point on s depends on the position from which it is viewed.
Let x and y be two points such that each one lies either on ∂ G or on a segment of M. We say that x and y are visible if
the open segment (x, y ) is contained in the interior of G and crosses no segment of M. We say that x and y are color-visible
if they are visible and the color of x when viewed from y is equal to the color of y when viewed from x; see Fig. 3 for an
example.
3.2. Basic operators for well-colored PSLGs
Let z be a point in the interior of a segment s = [a, b] of M and let z be a non-reﬂex point on ∂ G such that z and z are
color-visible. The Glue operator produces a new PSLG by attaching s to ∂ G using z and z as points of attachment. Formally,
if z is not a vertex of G, then insert it as a vertex by splitting the edge of G that contains z . Add the vertices z, a and b
and the edges [ z, z ], [ z, a] and [ z, b] to G. In the resulting PSLG, denoted by Glue(G , z, z ), a and b are both reﬂex vertices
of degree one; see Fig. 4.
Let y and y be two color-visible points on ∂ G such that neither y nor y is a reﬂex vertex. The Cut operator joins y
with y in the following way. Let F be the face of G that contains the segment [ y , y ]. If either y or y is not a vertex of G,

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

627

Fig. 4. Two pairs of color-visible points z, z and y , y , where z and z can be joined by the Glue operator and y and y by the Cut operator. (For
interpretation of the references to color in this ﬁgure, the reader is referred to the web version of this article.)

insert it by splitting the edge where it lies on. Thus, [ y , y ] is a chord of F , so adding the edge [ y , y ] to G splits F into
two new faces. In this way, we obtain a new PSLG Cut(G , y , y ) with one face more than G; see Fig. 4 for an illustration of
this operation.
Since both operators join two points by adding the edge between them, we can deﬁne an operator GlueCut on G , z
and z , that behaves like Glue when z belongs to a segment in M, or behaves like Cut if both z and z belong to ∂ G. The
PSLG output by this operator is denoted by GlueCut(G , z, z ).
A Glue-Cut Graph (GCG) is a well-colored PSLG where every reﬂex vertex has degree one. Although this deﬁnition is more
general, we can think of a GCG as a PSLG obtained by repeatedly applying GlueCut operations between a polygon (initially
convex) and the segments of a BR-matching contained in its interior; see Fig. 4 for an example.
Lemma 3.1. The family of Glue-Cut Graphs is closed under the GlueCut operator.
Proof. Let G be a GCG and z be a point in a bichromatic segment s contained in the interior of G. Let z , y and y be points
on ∂ G such that z and z (resp. y and y ) are color-visible. When constructing Glue(G , z, z ), the endpoints of s become
reﬂex vertices of degree one. That is, we add one red and one blue reﬂex vertex to G. Therefore, to prove that Glue(G , z, z )
is a GCG, it suﬃces to show that it is well-colored. This, however, is guaranteed by the color-visibility of z and z ; see Fig. 4.
On the other hand, Cut(G , y , y ) neither adds nor removes reﬂex vertices of G. This operation divides a well-colored face
of G into two, by inserting a new edge. Consider either of the new faces. Let a, b be the ﬁrst reﬂex vertices found when
following the boundary from this edge in each direction. Since y and y are color-visible when Cut is invoked, we know
that a and b are of different colors. Thus, each new face, and therefore Cut(G , y , y ), is well-colored; see Fig. 4. ✷
3.3. Simpliﬁcation of a GCG
Let F = ( v 1 , v 2 , . . . , v k , v 1 ) be a face of a GCG given as a sequence of its vertices in clockwise order along its boundary.
For each vertex v i , if the triple v i −1 , v i , v i +1 makes a right turn, let xi be a point at distance ε > 0 from v i , lying on the
bisector of the convex angle formed by [ v i −1 , v i ] and [ v i , v i +1 ]. If v i is reﬂex in F , let xi = v i . Otherwise, if v i −1 , v i , v i +1
are collinear, do nothing. Let P F = (x1 , . . . , xk , x1 ) (consider only the indices where xi is deﬁned). By choosing ε suﬃciently
small, we obtain the following result; see Fig. 5.
Observation 3.2. For every bounded face F of a GCG, P F is a simple polygon contained in F such that F and P F share the same set of
reﬂex vertices.
We call P F a simpliﬁcation of F . Though the simpliﬁcation of a face F is not unique as it depends on the choice of ε , the
results presented in this paper hold for any simpliﬁcation. Therefore, when referring to P F , we refer to any simpliﬁcation
of F .
Let F 1 , . . . , F k be the bounded faces of a GCG G. We call PG = P F i the simpliﬁcation of G. Note that PG is the union of
a set of disjoint simple polygons.
3.4. Merging a matching with a GCG
The following result is a special case of Lemma 5 of [14].
Lemma 3.3. Let P be a simple polygon with an even number of reﬂex vertices. There exists a perfect planar matching M of the reﬂex
vertices of P such that each segment of M is contained in P (or on its boundary).

628

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

Fig. 5. A face F of a GCG G and its simpliﬁcation P F , contained in F , with the same set of reﬂex vertices.

Fig. 6. A GCG and a BR-matching of its reﬂex vertices.

Let C = {r0 , . . . , rk } be the set of reﬂex vertices of a simple polygon P sorted along its boundary. Let M be a perfect
planar matching of C that exists by Lemma 3.3. Let [r i , r j ] be a segment of M, and note that this segment splits P into two
sub-polygons. Notice that if [r i , r j ] is contained in the boundary of P , then one sub-polygon is a segment and the other
one is P itself. In order for M to be perfect and planar, each sub-polygon must contain an even number of reﬂex vertices.
Therefore, if a segment [r i , r j ] belongs to M, then i mod 2 = j mod 2. This implies that if P is well-colored, then M is a
BR-matching of the reﬂex vertices of P .
The main tool to construct BR-matchings of the reﬂex vertices of a GCG is provided by the following lemma; see Fig. 6
for an illustration.
Lemma 3.4. If G is a GCG, then there is a BR-matching M of the reﬂex vertices of G, such that each segment of M is contained in PG
(or on its boundary).
Proof. Let F 1 , . . . , F k be the well-colored faces of G. By Observation 3.2, each F i and its simpliﬁcation P F i share the same
set of reﬂex vertices. By Lemma 3.3, there is a matching M i of the reﬂex vertices of P F i , such that each segment lies either
in the interior or on the boundary of P F i . Since F i is well-colored, M i is a BR-matching. Note that a vertex can be reﬂex in
at most one face of G. Therefore, M = M i is a BR-matching of the reﬂex vertices of G and each segment of M lies either
in the interior or on the boundary of PG . ✷
3.5. Gluing BR-matchings
Let X be a GCG and let M be a BR-matching contained in the interior of X . In this section, we show how to glue the
segments of M to the boundary of X . In this way, we obtain a GCG G such that the endpoints of the segments of M are all
reﬂex vertices of G. Thus, by Lemma 3.4, we can obtain a BR-matching M of the reﬂex vertices of G where every segment
is contained in PG , i.e. we can obtain a BR-matching M whose union with M contains no crossings.
Assume that the vertices of X and the endpoints of M are in general position and that no two points have the same
x-coordinate.
Let s be the segment with the rightmost endpoint among all segments of M. We may assume that the left (resp. right)
endpoint of s is blue (resp. red) and hence, that s is blue (resp. red) when viewed from below (resp. above).
Extend s to the right until it reaches the interior of a segment s on ∂ X at a point y and choose a point y in the interior
of s above (resp. below) y if s is red (resp. blue) when viewed from s. Choose y suﬃciently close to y so that the whole

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

629

Fig. 7. Gluing a bichromatic segment with the boundary of a GCG.

Fig. 8. An isolable vertex v that lies outside of the simpliﬁcations of each of its adjacent faces.

segment s is visible from y . This is always possible because y is visible from the right endpoint of s. Let m be the midpoint
of s and note that m and y are color-visible by construction.
Let X = Glue( X , m, y ). By Lemma 3.1, X is a GCG. Moreover, the endpoints of s become reﬂex vertices of X ; see Fig. 7.
Remove s from M, let X = X and repeat this construction recursively until M is empty. We obtain the following result.
Lemma 3.5. Let X be a GCG and M be a BR-matching contained in the interior of X . There is a GCG G augmenting X such that all
reﬂex vertices of X and all endpoints in M are reﬂex vertices in G. Moreover, every segment of M is contained in ∂ G.
4. Removing crossings with chromatic cuts
In this section, we provide the proof of Lemma 2.2 presented in Section 2.
Let M be a BR-matching of P and let be a chromatic cut of M. Recall that M denotes the set of segments of M that
cross . We show that it is possible to obtain a new BR-matching M with at least one segment s of M absent. Furthermore,
when examining segments of M that cross below s, all segments of M are preserved in M and no new segments are
introduced.
The following observation is depicted in Fig. 8.
Observation 4.1. Let v be a vertex of a GCG X . If no line through v, intersecting the interior of X , supports a closed halfplane containing
all the neighbors of v, then v lies outside of P X . Moreover, the open segments joining v with its neighbors also lie outside of P X .
A vertex v of a GCG is isolable if it satisﬁes the conditions of Observation 4.1.
Let be a chromatic cut of M and assume that M = {s1 , . . . , sk } is sorted from bottom to top according to the intersection, xi , of si with .
The idea of the proof is to construct a GCG X augmenting M, using Lemma 3.5, in such a way that x1 , . . . , x j become
isolable vertices of X for some 1 ≤ j ≤ k. Furthermore, we require X to contain the edge between xi and xi +1 for every
1 ≤ i < j. By Observation 4.1, these edges will lie outside of P X and so will the portion of
lying below s j . Thus, this
portion of will not be crossed by a BR-matching, compatible with M, obtained by applying Lemma 3.4 to X .
Notice that we can only glue xi with xi +1 if they are color-visible. Although the following lemma shows that there is at
least one pair of consecutive color-visible points among x1 , . . . , xk , we may not be able to glue all of them. Thus, we will
resort to a different strategy that allows us to alter the color of a segment.
Lemma 4.2. There exist two consecutive segments si and si +1 in M such that xi and xi +1 are color-visible.

630

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

Fig. 9. Case where there is at least one point, lying above s1 , on segment s2 , s L or s R that is color-visible with x1 .

Proof. Because is a vertical chromatic cut, there exist two segments s j and sh in M such that the left endpoint of s j is
of different color than the left endpoint of sh . Therefore, there must exist segments si and si +1 whose left endpoints have
different colors. This implies that the color of si when viewed from above is the same as the color of si +1 when viewed
from below. Finally, since si and si +1 are consecutive segments in M , xi and xi +1 are visible. ✷
We proceed to describe the construction of the GCG that augments M. Let R be a convex polygon strictly containing all
segments of M. Assume without loss of generality that the left endpoint of s1 is blue, implying that s1 is red from above and
blue from below. Let x0 be the bottom intersection between and R. Since the bounded face of R contains no reﬂex vertex,
we can assume that x0 is blue when viewed from x1 . That is, x0 and x1 are color-visible. Finally, let X 1 = Glue(R, x1 , x0 ) be
the GCG obtained by joining x0 with x1 ; see Fig. 9.
Consider the edge of R containing x0 to be a segment s0 . The following invariants on the GCG X i hold initially for i = 1
and are maintained throughout.

•
•
•
•
•

The points xi and xi +1 are visible while xi and xi −1 are neighbors.
Besides xi −1 , vertex xi neighbors two vertices on si , one to the left and one to the right of .
The endpoints of si are reﬂex vertices of X i .
The endpoints of si −1 are not reﬂex in X i and xi −1 is an isolable vertex.
The color of si , when viewed from a point lying above si , is given by the color of the right endpoint of si .

Our objective is to ﬁnd a point, color-visible with xi , that lies above the line extending si . If such a point exists, by gluing
it to xi and then merging the remaining segments of M using Lemma 3.5, we obtain a GCG X that augments M with the
desired properties (a full explanation is presented in Section 4.2, an example is depicted in Fig. 9).
As long as no such point exists, we iteratively augment X i , maintaining the above properties as an invariant. This is done
using the Augment(i ) procedure (deﬁned in more detail below), which takes a GCG X i and adds edges (including the edge
between xi and xi +1 ) to produce a new GCG X i +1 where the above properties hold again. After several augmentations, we
will produce a GCG where the desired color-visible point will be found.
Procedure Augment(i )
Refer to Fig. 10 for an illustration of this procedure. Let li and r i be the left and right endpoints of si , respectively.
Assume without loss of generality that li is colored blue (and r i is red). Thus, si is red when viewed from above. Extend si
on both sides and let s L (resp. s R ) be the ﬁrst segment reached to the left (resp. right). This procedure is only used when
the points in si +1 , s L and s R appear blue when viewed from xi . Otherwise, Augment is not required as there is a point in
either si +1 , s L or s R , lying above si , that is color-visible with xi .
Notice that si +1 , s L , and s R could belong either to M, or to ∂ X i . Let y L and y R be the points where the line extending si
intersects s L and s R , respectively. Let X i be the PSLG obtained by adding the edges [li , y L ] and [r i , y R ] to X i ( y L and y R are
added as vertices).
This may create new faces depending on whether s L or s R belong to M. Vertices y L , li , xi , r i , y R are collinear, meaning li
and r i are no longer reﬂex vertices in X i . Thus, the color of si will now be blue when viewed from above or from below.
Furthermore, if s L or s R belong to M, then their endpoints are now reﬂex vertices of X i . One can verify that X i is wellcolored since y L and y R are both blue when viewed from xi , hence X i is a GCG. See Fig. 10(b) for an illustration. Notice
that, when viewed from above, the color of xi is now blue, in contrast with the red color that xi had in X i . Therefore, since
xi +1 is blue when viewed from below, xi +1 and xi are now color-visible in X i and can be glued.
Let X i +1 = GlueCut( X i , xi +1 , xi ). This way, the endpoints of si +1 become (if they were not already) reﬂex vertices of the
GCG X i +1 and xi becomes an isolable vertex. Notice that no vertex on si +1 neighbors a point lying above si +1 . Therefore,

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

631

Fig. 10. (a) Example where procedure Augment(1) is required. Points above s1 that lie on segments s2 , s L and s R are not color-visible with x1 . (b) The
construction obtained by extending s1 , where two reﬂex vertices l1 , r1 disappear to let x1 and x2 become color-visible.

the color of every point on segment si +1 , when viewed from above, is given by the color of the right endpoint of si +1 . In
fact, the invariant properties are maintained, should there be a subsequent use of Augment.
4.1. Analysis of AUGMENT
Observation 4.3. On each iteration of Augment, all reﬂex vertices of X i are preserved in X i +1 , except for the two endpoints of si that
become non-reﬂex.
Lemma 4.4. The procedure Augment will only be used O (n) times before producing a GCG X j where there exists a point, lying above
the segment s j , that is color-visible with x j (for some 1 ≤ j ≤ k − 1).
Proof. By Lemma 4.2, there exist segments sh , sh+1 ∈ M such that xh and xh+1 are color-visible before executing Augment
on X 1 . We claim that Augment can only go as far as to construct X h . If X h is not constructed, it is because a GCG X j was
constructed (for some 0 ≤ j < h) where there exists a point, lying above the segment s j , that is color-visible with x j . Otherwise, if X h is constructed, then, by the preserved invariants, the color of xh , when viewed from above, remains unchanged
and hence xh and xh+1 are color-visible. ✷
4.2. Processing after AUGMENT
By Lemma 4.4, we know that after the last call to Augment we obtain a GCG X j such that there is a point in either
s j +1 , s L or s R , lying above s j , that is color-visible with x j . Assume without loss of generality that x j is red when viewed
from above. If s j +1 is red when viewed from below, then x j and x j +1 are color-visible. In this case, we deﬁne G M , =
GlueCut( X j , x j +1 , x j ).
If x j +1 is blue when viewed from x j , we follow a different approach. Recall that the endpoints of s j are reﬂex vertices.
If s L is red when viewed from the left endpoint of s j , choose a point y, slightly above y L on s L , such that the whole segment s j is visible from y. Since x j is red when viewed from above, x j and y are color-visible. Let G M , = GlueCut( X j , y , x j );
see Fig. 11. An analogous construction of G M , follows if s R is red when viewed from the right endpoint of s j . We call G M ,
the extension of X j .
Lemma 4.5. If G M , is an extension of X j , then the following properties hold:

• The endpoints of s j are reﬂex vertices of G M , , but s j is not contained in PG M , .
• The downwards ray with apex at x j does not intersect PG M , .
• For every 1 ≤ i < j, the endpoints of si are not reﬂex vertices of G M , . Moreover, si is not contained in PG M , .
Proof. By the invariants of Augment, x j neighbors x j −1 as well as two vertices on s j , one to the left and one to the right
of . Since x j also neighbors a vertex in G M , lying above the segment s j , x j is an isolable vertex in G M , . Thus, by the
preserved invariants and by Observation 4.1, for every 1 ≤ i ≤ j, xi lies outside of PG M , and hence the segment si is not
contained in PG M , . Furthermore, the segment joining xi with xi −1 also lies outside of PG M , and so does the downwards
ray with apex at x j . Finally, Observation 4.3 tells us that, for every 1 ≤ i < j, no endpoint of si is a reﬂex vertex of X j (nor
of G M , ). ✷

632

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

Fig. 11. Case where x1 and x2 are not color-visible, but a point y can be found in s L so that x1 and y are color-visible.

We are now ready to provide the proof of Lemma 2.2 which is restated for ease of readability.
Lemma 2.2. Let M be a BR-matching of P and let be a chromatic cut of M. There exists a BR-matching M of P compatible with M
with the following properties: There is a segment s of M \ M that crosses such that all segments of M that cross below s also belong
to M . Moreover, these are the only segments of M crossing below s.
Proof. Let G M , be the GCG obtained using the construction presented in this section on M and . Recall that M is the set
of segments of M that cross . Lemma 4.5 states that there is a segment s j ∈ M , such that its endpoints are reﬂex vertices
of G M , but s j is not contained in PG M , . Let W be the set of segments in M that are contained in the interior of G M , and
let Z = {s1 , . . . , s j −1 } be the set of segments of M that cross below x j . By Lemma 4.5, we know that Z ∩ W = ∅.
By Lemma 3.5 and from the fact that W is contained in the interior of G M , , we can extend G M , by gluing the segments
of W to its boundary such that the endpoints of every segment in W become reﬂex vertices in G M , . Moreover, the reﬂex
vertices of G M , are preserved.
By Lemma 3.4, there exists a BR-matching W of the reﬂex vertices of G M , such that each segment in W is contained
in PG M , . Notice that the endpoints of s j are re-matched in W . However, since s j is not contained in PG M , , s j does not
belong to W . Moreover, Lemma 4.5 implies that the ray, shooting downwards from x j , lies outside PG M , . Thus, no segment
in W crosses below x j .
Let M = W ∪ Z be a set of bichromatic segments. Every point in P is matched in M since every point in P is either a
reﬂex vertex of G M , , or an endpoint of a segment in Z . Lemma 4.5 implies that the endpoints of the segments in Z are
not reﬂex vertices in G M , . Therefore, M is a BR-matching of P . Since W and W are compatible, M and M are compatible
BR-matchings. ✷
5. Remarks
Although the techniques developed in this paper appear tailored for this speciﬁc problem, they have a more general
underlying scope. At a deeper level, our tools generate a balanced convex partition of the plane. Roughly speaking, in
Lemma 3.3 a simple polygon is partitioned into a set of convex polygons obtained by shooting rays from the reﬂex vertices
towards the interior of the polygon until hitting its boundary. Once the polygon is partitioned, a matching can be found
on each convex piece. By using Lemma 3.3 in the bichromatic setting, we generate a convex partition of the GCGs, where
each convex face is in charge of matching a balanced number of red and blue points. Convex partitions, usually constructed
by extending segments until they reach another segment or a previously extended section, have been extensively used to
solve several augmentation and reconﬁguration problems [5,1,10,12,15]. Therefore, the techniques provided in this paper are
of independent interest. In conjunction with Lemma 3.4, operators like Glue and Cut can be used to ﬁnd special convex
partitions that provide new ways to construct compatible PSLGs.
Recently, Aichholzer et al. [16] adapted some of the tools presented in this paper and showed that there is always a
sequence of length O (n) that connects any two BR-matchings. This result, together with the lower bound of Ω(n) presented
in this paper yield a tight bound of Θ(n) for the length of any compatible sequence that connects two given BR-matchings.
Acknowledgements
We thank the authors of [1] for highlighting the open problem from their paper to the audience of the EuroGIGA meeting
that took place after EuroCG 2012. We would also like to thank Tillmann Miltzow for useful comments.

G. Aloupis et al. / Computational Geometry 48 (2015) 622–633

633

References
[1] O. Aichholzer, F. Hurtado, B. Vogtenhuber, Compatible matchings for bichromatic plane straight-line graphs, in: Proceedings of EuroCG, 2012,
pp. 257–260.
[2] F. Hurtado, C.D. Tóth, Plane geometric graph augmentation: a generic perspective, in: J. Pach (Ed.), Thirty Essays on Geometric Graph Theory, in: LNCS,
Springer, Berlin/Heidelberg, 2013, pp. 327–354.
[3] O. Aichholzer, F. Aurenhammer, C. Huemer, H. Krasser, Transforming spanning trees and pseudo-triangulations, Inf. Process. Lett. 97 (1) (2006) 19–22,
http://www.sciencedirect.com/science/article/pii/S0020019005002486.
[4] O. Aichholzer, F. Aurenhammer, F. Hurtado, Sequences of spanning trees and a ﬁxed tree theorem, Comput. Geom. 21 (2002) 3–20, http://www.
sciencedirect.com/science/article/pii/S0925772101000426.
[5] O. Aichholzer, S. Bereg, A. Dumitrescu, A. García, C. Huemer, F. Hurtado, M. Kano, A. Márquez, D. Rappaport, S. Smorodinsky, D. Souvaine, J. Urrutia, D.R.
Wood, Compatible geometric matchings, Comput. Geom. 42 (2009) 617–626, http://www.sciencedirect.com/science/article/pii/S0925772109000029.
[6] K. Buchin, A. Razen, T. Uno, U. Wagner, Transforming spanning trees: a lower bound, Comput. Geom. 42 (8) (2009) 724–730, http://www.sciencedirect.
com/science/article/pii/S0925772109000169.
[7] F. Hurtado, Flipping edges in triangulations, Discrete Comput. Geom. 22 (3) (1999) 333–346, http://dx.doi.org/10.1007/PL00009464, http://ci.nii.ac.jp/
naid/30002429420/en/.
[8] F. Hurtado, M. Noy, The graph of triangulations of a convex polygon, in: Proceedings of SoCG, ACM, New York, NY, USA, 1996, pp. 407–408.
[9] A. Razen, A lower bound for the transformation of compatible perfect matchings, in: Proceedings of EuroCG, 2008, pp. 115–118.
[10] M. Ishaque, D.L. Souvaine, C.D. Tóth, Disjoint compatible geometric matchings, in: Proceedings of SoCG, ACM, New York, NY, USA, 2011, pp. 125–134.
[11] M. Sharir, E. Welzl, On the number of crossing-free matchings, cycles, and partitions, in: Proceedings of SODA, ACM, New York, NY, USA, 2006,
pp. 860–869.
[12] F. Hurtado, M. Kano, D. Rappaport, C.D. Tóth, Encompassing colored planar straight line graphs, Comput. Geom. 39 (1) (2008) 14–23, http://
dx.doi.org/10.1016/j.comgeo.2007.05.006, http://www.sciencedirect.com/science/article/pii/S0925772107000648.
[13] J. Matousek, Using the Borsuk–Ulam Theorem, Lectures on Topological Methods in Combinatorics and Geometry, Springer Publishing Company, Inc.,
2007.
[14] M. Abellanas, A. García, F. Hurtado, J. Tejel, J. Urrutia, Augmenting the connectivity of geometric graphs, Comput. Geom. 40 (2008) 220–230, http://
dx.doi.org/10.1016/j.comgeo.2007.09.001, http://www.sciencedirect.com/science/article/pii/S0925772107000934.
[15] M. Hoffmann, B. Speckmann, C.D. Tóth, Pointed binary encompassing trees: simple and optimal, Comput. Geom. 43 (1) (2010) 35–41, http://
dx.doi.org/10.1016/j.comgeo.2006.12.005, http://www.sciencedirect.com/science/article/pii/S0925772109000443.
[16] O. Aichholzer, L. Barba, T. Hackl, A. Pilz, B. Vogtenhuber, Linear transformation distance for bichromatic matchings, in: Proceedings of SoCG’14, 2014,
Kyoto, Japan, ACM, New York, ISBN 978-1-4503-2594-3, 2014, pp. 154–162, arXiv:1312.0884.

