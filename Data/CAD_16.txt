Computer-Aided Design 70 (2016) 36–45

Contents lists available at ScienceDirect

Computer-Aided Design
journal homepage: www.elsevier.com/locate/cad

Geometric characteristics of a class of cubic curves with
rational offsets✩
Xing-Jiang Lu a , Jianmin Zheng b,∗ , Yiyu Cai c , Gang Zhao d
a

Mathematics Department, Zhejiang University, Hangzhou 310027, China

b

School of Computer Engineering, Nanyang Technological University, Singapore 639798, Singapore

c

School of Mechanical and Aerospace Engineering, Nanyang Technological University, Singapore 639798, Singapore

d

School of Mechanical Engineering and Automation, Beihang University, Beijing 100191, China

highlights
• This paper presents a geometric characterization of cubic indirect-PH curves.
• We give a construction of G1 Hermite interpolation using indirect-PH curves.
• The optimal indirect-PH curve to G1 Hermite interpolation is investigated.

article

info

Keywords:
Bézier curves
Offsets
Rational parameterization
Pythagorean hodograph
G1 Hermite interpolation

abstract
Planar Bézier curves that have rationally parameterized offsets can be classified into two classes. The first
class is composed of curves that have Pythagorean hodographs (PH) and the second class is composed
of curves that do not have PHs but can have rational PHs after reparameterization by a fractional
quadratic transformation. This paper reveals a geometric characterization for all properly-parameterized
cubic Bézier curves in the second class. The characterization is given in terms of Bézier control polygon
geometry. Based on the derived conditions, we also present a simple geometric construction of G1 Hermite
interpolation using such Bézier curves. The construction results in a one-parameter family of curves if a
solution exists. We further prove that there exists a unique value of the parameter which minimizes the
integral of the squared norm of the second order derivative of the curves.
© 2015 Elsevier Ltd. All rights reserved.

1. Introduction
This paper deals with a class of Bézier curves that possess
rational offset curves. Bézier curves are a common type of representations for free form curves in computer aided design and
manufacturing (CAD/CAM) [1]. Offsetting has diverse engineering
applications including CNC machining, motion planning, railway design, shape blending, etc. However, it is known that a
Bézier curve in general may not have a rational offset [2]. This actually motivated a lot of research on offset approximation [3–8].
On the other hand, the failure of preserving rationality of the offsetting results may cause extra cost in operations involving offsets

✩ This paper has been recommended for acceptance by Scott Schaefer and Charlie
C.L. Wang.
∗ Corresponding author.
E-mail address: asjmzheng@ntu.edu.sg (J. Zheng).

http://dx.doi.org/10.1016/j.cad.2015.07.006
0010-4485/© 2015 Elsevier Ltd. All rights reserved.

and software development as well. Therefore it is interesting to explore the curves that allow rational representation of their exact
offset curves.
In 1990, Farouki and Sakkalis introduced a class of polynomial
curves called Pythagorean hodograph (PH) curves [9]. A polynomial parametric curve is called a PH curve if the Euclidean norm of
the hodograph of the curve is a polynomial. Hence for PH curves,
their offset curves admit rational representation. Furthermore, PH
curves’ arc length can be expressed as a polynomial function of
the parameter. Since then, many works have followed. The idea
of PH curves was extended to spatial PH curves [10], rational PH
curves [11,12], Minkowski PH curves [13], etc. Also many methods
have been developed to perform Hermite interpolation using various PH curves [14–19]. One can easily find hundreds of papers in
these topics. Detailed review on PH curves and related topics can
be found in Chapter 17 of the Handbook of Computer Aided Geometric Design [1], book ‘‘Pythagorean-Hodograph Curves: Algebra

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45

and Geometry Inseparable’’ [20], a special issue of Computer Aided
Geometric Design in 2008 [21], and a recent survey [22].
Having a Pythagorean hodograph is only a sufficient condition
for the offset of a polynomial curve to be rational. For example,
the parabola does not belong to PH curves, but the offsets to the
parabola are rational [23]. It has been proved that the necessary
and sufficient condition for a properly-parameterized polynomial
curve on a plane to have rational offsets is that the squared norm
of its hodograph has at most two complex roots (with nonzero
imaginary part) of odd multiplicity [24–26]. PH curves are a special
case of such curves corresponding to the situation that the number
of complex roots with nonzero imaginary part of odd multiplicity is
zero. The curves in the complementary set of PH curves do not have
polynomial Pythagorean hodograph, but after reparameterization
via a quadratic parameter transformation, they can have a rational
Pythagorean hodograph. For convenience of description, in this
paper we call such curves in the complementary set indirect-PH
curves.
Note that sophisticated algebraic methods have been employed
to analyze and construct curves with rational offsets. For example,
the complex variable model was used for planar PH curves [27]
and indirect-PH curves [25], and the quaternion model was used
for spatial PH curves [28,29]. On the other hand, polynomial
curves are always representable in Bézier form and Bézier control
polygons provide an intuitive way to dealing with curves. While
in general the algebraic structure of the polynomial curves with
rational offsets is not simply transferred to intuitive constraints on
the control polygon geometry, Farouki and Sakkalis provided an
elegant geometric characterization for cubic PH curves [9], which
are two constraints on the lengths of legs and two interior angles of
the Bézier control polygons. Wang and Fang derived the geometric
characterization of quartic PH curves also in terms of Bézier control
polygons [30]. This thus provides a geometric approach for
constructing PH quartics. The use of control polygons was also
proposed for designing planar C 2 PH quintic spline curves in [31].
In this paper, we are interested in intuitive geometric constraints for cubic Bézier curves to be indirect-PH curves based on
Bézier control polygons. Except for some brief description of cubic indirect-PH curves in [25], no work has been published on
the full geometric characterization of them. The main contribution of this paper is that we convert the special algebraic
structure in the hodographs of indirect-PH curves into simple
geometric constraints and present the full geometric characterization of cubic indirect-PH curves. The geometric characteristics
are expressed using the lengths of edges and the interior angles of
a quadrilateral formed from the Bézier control polygons. Furthermore, we present the construction of a characterization diagram
for the Bézier control points. The idea of constructing a diagram to
characterize cubic curves has been used in [32–34]. Another contribution of the paper is a simple geometric construction of G1 Hermite interpolation using cubic indirect-PH curves. In particular, if
a single cubic indirect-PH curve is available for the input Hermite
data, the solution is actually a one-parameter family of curves. We
prove that there exists a unique value of the parameter that minimizes the integral of the squared norm of the second order derivative of the curves.
The paper is organized as follows. Section 2 briefly reviews
polynomial curves with rational offsets, which serve as the starting
point of our work. Section 3 then presents the full geometric
characterization of indirect-PH curves. The geometric construction
of G1 Hermite interpolation using indirect-PH curves is discussed
in Section 4. Section 5 provides some examples and Section 6
concludes the paper.

37

2. Preliminaries
The offset to a planar curve P (t ) = (x(t ), y(t )) can be written
as

(−y′ (t ), x′ (t ))
Po ( t ) = P ( t ) ± d 
2
x′2 (t ) + y′ (t )

(1)

where d is the offset distance.
Due to the square root in the denominator, Po (t ) is generally not
a rational curve. In case there exists a polynomial σ (t ) such that
x′2 (t ) + y′2 (t ) = σ 2 (t ), i.e., (x′ (t ), y′ (t ), σ (t )) form a ‘‘Pythagorean
triple’’, Po (t ) is a rational curve. Such P (t ) is called a PH curve [9].
The rationality of the offset curve Po (t ) actually depends on
whether the square root has a rational parameterization. The
necessary and sufficient condition for a properly-parameterized
polynomial curve to have rational offsets can be described by the
following theorem [25].
Theorem 1. A properly-parameterized polynomial curve P (t ) =
(x(t ), y(t )) has rationally parameterized offsets if and only if the
hodograph (x′ (t ), y′ (t )) has the following decomposition:
x′ (t ) + iy′ (t ) = ρ(t ) [(λt + 1) + iµt] [u(t ) + iv(t )]2

(2)

√
−1 is the imaginary unit, ρ(t ), u(t ) and v(t ) are
where i =
polynomials of t with real coefficients, λ and µ are real numbers, and
u(t ) and v(t ) are relatively prime.
The decomposition (2) can be classified into two cases corresponding to the two classes of polynomial curves with rational offsets: PH curves and indirect-PH curves.

• µ = 0. We have
x′ (t ) = ρ(t )(λt + 1)(u2 (t ) − v 2 (t )),
y′ (t ) = ρ(t )(λt + 1)(2u(t )v(t )).

2

Hence x′2 (t ) + y′2 (t ) = ρ(t )(λt + 1)(u2 (t ) + v 2 (t )) , which
implies that P (t ) is a PH curve. A linear curve (i.e., straight line
segment) is a PH curve with λ = 0 and ρ, u, v being constant.



• µ ̸= 0. The root of (λt + 1) + iµt = 0 is a complex num−λ+iµ
ber λ2 +µ2 , which is also a root of x′2 (t ) + y′2 (t ) = 0 with odd
multiplicity. Therefore the curve P (t ) in this case is not a PH
curve. However, we introduce a quadratic parameter transformation [25]:
t (s) =

B21 (s) + (c − 1 + b)B22 (s)

(c + 1 − b) (s) + (1 + b)B21 (s) + (c − 1 + b)B22 (s)
B20

(3)

where




(λ + 1)2 + µ2 ,
c = (λ + 2)2 + µ2 ,
 
2
and B2i (t ) = i (1 − t )2−i t 2 are quadratic Bernstein polynomials. It is obvious that t (0) = 0 and t (1) = 1. After the parameter transformation, the curve P (t (s)) has a rational Pythagorean
b=

hodograph. In fact, it is sufficient to verify that

(λt + 1)2 + (µt )2

2
2
2
(c + 1 − b)B20 (s) + c −(12−b) B21 (s) + b(c − 1 + b)B22 (s)
=
.
(c + 1 − b)B20 (s) + (1 + b)B21 (s) + (c − 1 + b)B22 (s)
Therefore the curves in this class are indirect-PH curves.

38

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45

3. Geometric characteristics of cubic indirect-PH curves

Note that Eq. (5) can be re-written as

Consider a cubic properly-parameterized curve P (t ) in the class
of indirect-PH curves. According to Theorem 1, it must have a
decomposition of (2). Since the derivative P ′ (t ) is quadratic and
µ ̸= 0, both u(t ) and v(t ) must be constant, and u2 + v 2 ̸= 0 (i.e.,
u and v cannot be zero simultaneously). Moreover, ρ(t ) is linear in
t. After some calculation, we obtain

λ
P (t ) = ρ(t )(u − v , 2uv)
−µ
′

2



2


µ
t + ρ(t )(u2 − v 2 , 2uv).
λ

P1 = P0 +

µ
.
λ+1


(4)
P2 = P3 −

Since u + v ̸= 0, u − v and 2uv cannot be zero simultaneously,
from which we can conclude that T0 ̸= 0, T1 ̸= 0 and T0 ∦ T1 . Thus
we have
2

2

2

Theorem 2. A cubic properly-parameterized curve P (t ) = (x(t ),
y(t )) is an indirect-PH curve if and only if

(x (t ), y (t )) = [ρ0 (1 − t ) + ρ1 t] [T0 (1 − t ) + T1 t]
′

′

We further have

Proof. A cusp on a curve refers to a point where the unit
tangent vector of the curve is discontinuous. For cubic properlyparameterized indirect-PH curve P (t ), it contains a cusp if and only
if ρ0 (1 − t ) + ρ1 t has a root within [0, 1] since T0 , T1 are two nonparallel vectors. This is equivalent to ρ0 ρ1 ≤ 0.
Remark 1. Theorem 2 tells that for a cubic indirect-PH curve, its
hodograph can be expressed by a linear vector with respect to
parameter t multiplied by a linear scalar function ρ(t ). This means
that a cubic indirect-PH curve is actually an LN curve introduced
by Ahn and Hoffmann [35], though a higher degree indirect-PH
curve is not necessarily an LN curve. The term ‘‘LN’’ stands for
linear normal, which was introduced by Jüttler in the surface
case [36]. LN curves have linearly varying normals and play an
important role in convolution. They are special instances of curves
possessing a rational support function [37]. This paper focuses
on cubic indirect-PH curves (i.e., cubic LN curves). We analyze
their geometric characteristics in terms of Bézier control polygon
geometry, a full exploration of which was not done before.

P (t ) = (x(t ), y(t )) =

3


Pi B3i (t ),

t ∈ [0, 1]

(6)

i =0

(1 − t )3−i t i are cubic Bernstein polynomials

and P0 , P1 , P2 and P3 are the four control points. The hodograph
can be expressed as

(x′ (t ), y′ (t )) = 3(P1 − P0 )B20 (t ) + 3(P2 − P1 )B21 (t )
+ 3(P3 − P2 )B22 (t ).

(7)

.

3

ρ1

T0 ,
(8)

T1 .

3
Substituting them into the third equation of (7) gives

ρ0 T1 + ρ1 T0

ρ 1 T1

= P3 − P0 −

2

3

−

ρ0 T0
3

,

i.e.,
P0 +

ρ

0

+

3

ρ1 

T0 = P3 −

6

ρ

1

+

3

ρ0 
6

T1 .

(9)

Corollary 4. If a cubic properly-parameterized Bézier curve P (t )
of (6) is an indirect-PH curve, its first and last control points could
not coincide, i.e., P0 ̸= P3 .
ρ1 

ρ0 

 ρ1

 ρ0
3

+

ρ1 
6

T0 = −

 ρ1
3

+

ρ0 
6

T1 . Since

 ρ0
3

+

and 3 + 6 cannot be zero simultaneously, T0 and T1 are
6
parallel, which contradicts Theorem 2.

ρ

ρ

ρ



ρ



Let I = P0 + 30 + 61 T0 = P3 − 31 + 60 T1 . If we denote
the line going through P0 and having direction T0 by L0 and the line
going through P3 and having direction T1 by L3 . I is a point on both
lines L0 and L3 .
Let h = ρ1 /ρ0 . We have

ρ

I − P0 =

0

3

+


=

1+

ρ1 

h

6



2

T0 =

ρ

0

3

(P1 − P0 ).

+

ρ1  3(P1 − P0 )
6
ρ0
(10)

Similarly,


I − P3 =

1+

1
2h



(P2 − P3 ).

(11)

Using Eqs. (7)–(11), we now analyze the geometric characterization of cubic indirect-PH curves in eight different cases according
to the value of h.
Case 1. h = ∞ (i.e., ρ0 = 0, ρ1 ̸= 0)
In this case, Eqs. (7), (8), (10) and (11) respectively give
P1 = P0 ,
3
T1 =
(P3 − P2 ),

We write P (t ) in Bézier form:

3
i

ρ0

Proof. If P0 = P3 , then

Corollary 3. If a cubic properly-parameterized curve P (t ) = (x(t ),
y(t )) is an indirect-PH curve, it does not contain a cusp within the
parameter domain [0, 1] if and only if ρ0 ρ1 > 0.

where B3i (t ) =

ρ 0 T1 + ρ 1 T0

(5)

where T0 , T1 are two non-parallel vectors, and ρ0 , ρ1 are two numbers
satisfying ρ02 + ρ12 ̸= 0.

 

3(P3 − P2 ) = ρ1 T1 ,
2
From the first two equations of (7), we have

T0 = (u2 − v 2 , 2uv),

2

3(P1 − P0 ) = ρ0 T0 ,

3(P2 − P1 ) =

Let


λ+1
T1 = (u2 − v 2 , 2uv)
−µ

ρ 0 T1 + ρ 1 T0

B21 (t ) + ρ1 T1 B22 (t ).
2
Comparing the above two representations of the hodograph
gives

(x′ (t ), y′ (t )) = ρ0 T0 B20 (t ) +

ρ1

I − P0 =
I = P2 .

ρ1
6

T0 ,

On the other hand, if four control points P0 , P1 , P2 and P3
are given in this way (i.e., P0 = P1 ̸= P3 , P0 , P2 , P3 are
not collinear as shown in Fig. 1), we let ρ0 = 0, ρ1 = 1,
T0 = 6(P2 − P0 ) and T1 = 3(P3 − P2 ). T0 ∦ T1 . Then
condition (5) holds and P (t ) is an indirect-PH curve.

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45

Fig. 1. Case 1 (h = ∞, i.e., ρ0 = 0, ρ1 ̸= 0) where a cubic Bézier curve is an
indirect-PH curve. The Bézier curve is shown in purple color (as the same as in
Figs. 2–8). (For interpretation of the references to color in this figure legend, the
reader is referred to the web version of this article.)

Fig. 2. Case 2 (h = 0, i.e., ρ0 ̸= 0, ρ1 = 0) where a cubic Bézier curve is an indirectPH curve. (For interpretation of the references to color in this figure legend, the
reader is referred to the web version of this article.)

39

Fig. 4. Case 4 (h = − 12 ) where a cubic Bézier curve is an indirect-PH curve. (For
interpretation of the references to color in this figure legend, the reader is referred
to the web version of this article.)

Fig. 5. Case 5 (h > 0) where a cubic Bézier curve is an indirect-PH curve. (For
interpretation of the references to color in this figure legend, the reader is referred
to the web version of this article.)

Let d1 = ∥I − P0 ∥, d2 = ∥I − P3 ∥, l0 = ∥P0 − P3 ∥, l1 =
∥P1 − P0 ∥, l3 = ∥P3 − P2 ∥. Then
l1 =

2
h+2

d1 ,

l3 =

2h
2h + 1

d2 .

Eliminating h from these two equations gives



d1
l1

Fig. 3. Case 3 (h = −2) where a cubic Bézier curve is an indirect-PH curve. (For
interpretation of the references to color in this figure legend, the reader is referred
to the web version of this article.)

Case 2. h = 0 (i.e., ρ0 ̸= 0, ρ1 = 0)
This is ‘symmetric’ to Case 1 (see Fig. 2). We have
P2 = P3 , T0 = ρ3 (P1 − P0 ) and I = P1 .
0
Case 3. h = −2
From (10) and (11), we have
I = P0 ,
P2 = P3 +

3

d1
sin β

I = P3 ,
4
3

(P3 − P0 ),

and P2 can be anywhere as long as it is not on the line
going through P0 and P3 .
Similarly, if P1 = P0 + 43 (P3 − P0 ), we just let ρ0 =

−2ρ1 , T0 =

3

ρ0

(P1 − P0 ), T1 =

=

l0

3

ρ1

(P3 − P2 ), which make

condition (5) be satisfied.
Case 5. h > 0


In this case, I − P0 = 1 + 2h (P1 − P0 ) has the same
direction as vector P1 −P0 , but alonger length than P1 −P0 .
1
Similarly, I − P3 = 1 + 2h
(P2 − P3 ) has the same
direction as vector P2 −P3 , but a longer length than P2 −P3 .

=

sin(α + β)

d2
sin α

sin β

l0

sin β



l1 sin(α + β)

let ρ1 = −2ρ0 , T0 = ρ3 (P1 − P0 ) and T1 = ρ3 (P3 − P2 ),
0
1
which make condition (5) be satisfied.
1
Case 4. h = − 2
This is ‘symmetric’ to Case 3 (see Fig. 4). We have

(12)

4

−1

.

sin α
l .
sin(α+β) 0

Thus d1 = sin(α+β) l0 , d2 =
into (12), we arrive at

(P0 − P3 ).

In this case, P1 can be anywhere as long as it does not lie
on the line containing P0 P3 (see Fig. 3).
On the other hand, if P2 = P3 + 43 (P0 − P3 ), we just

P1 = P0 +

l3

Denote the two interior angles of quadrilateral P0 P1 P2 P3
at P0 and P3 by α and β , respectively. Referring to Fig. 5,
in △P0 IP3 , the Law of Sines gives


4



d2
1
−1
−1 = .

sin α

l0

l3 sin(α + β)

Substituting them


−1 =

1
4

(13)

which is a geometric constraint expressed in terms of the
lengths and angles of quadrilateral P0 P1 P2 P3 .
It is also worth pointing out that when h = 1, we have
l1 = 23 d1 and l3 = 23 d2 . Thus the cubic Bézier curve can
be degree-reduced to a quadratic Bézier curve defined by
control points P0 , I and P3 .
Case 6. −2 < h < − 21
In this case, I − P0 has the same direction as vector
P1 − P0 , but a shorter length than P1 − P0 . I − P3 has the
same direction as vector P2 − P3 , but a shorter length than
P2 − P3 . Hence line segments P0 P1 and P3 P2 intersect at I
(see Fig. 6). In a similar way, we can obtain
l1 =

2
h+2

d1 ,

l3 =

2h
2h + 1

d2

and



d1
l1


−1

d2
l3


−1 =

1
4

.

(14)

In △P0 IP3 , the Law of Sines gives
d1
sin β

=

l0
sin(α + β)

=

d2
sin α

.

40

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45

Fig. 6. Case 6 (−2 < h < − 12 ) where a cubic Bézier curve is an indirect-PH curve.
(For interpretation of the references to color in this figure legend, the reader is
referred to the web version of this article.)
sin β
l
sin(α+β) 0

sin α
l .
sin(α+β) 0

Thus d1 =
, d2 =
Substituting them
into (14) gives (13).
Case 7. − 21 < h < 0
In this case, I − P0 has the same direction as vector
P1 − P0 , but a shorter length than P1 − P0 . The directions
of I − P3 and P2 − P3 are opposite. Then
2

l1 =

h+2

d1 ,

l3 =

−2h
2h + 1

d2 .

Eliminating h gives





d1

−1

l1

d2
l3



1

+1 =− .

(15)

4

Note that in this case the interior angle β is a reflex angle
(see Fig. 7). In △P0 IP3 , the Law of Sines gives
d1
sin(β − π )

=

l0
sin(2π − α − β)

=

d2
sin α

.

sin β

α
Thus d1 = sin(α+β) l0 , d2 = − sinsin
l . Substituting
(α+β) 0
them into (15) also gives (13).
Case 8. h < −2
This is ‘symmetric’ to Case 7. I − P3 has the same
direction as vector P2 − P3 , but a shorter length than
P2 − P3 . The directions of I − P0 and P1 − P0 are opposite.
Then

l1 =

−2
d1 ,
h+2

l3 =

2h
2h + 1

Fig. 7. Case 7 (− 12 < h < 0) where a cubic Bézier curve is an indirect-PH curve. (For
interpretation of the references to color in this figure legend, the reader is referred
to the web version of this article.)

d2 .

Fig. 8. Case 8 (h < −2) where a cubic Bézier curve is an indirect-PH curve. (For
interpretation of the references to color in this figure legend, the reader is referred
to the web version of this article.)

(v) Two rays R1 (u) = P1 + u(P1 − P0 ), u > 0 and R2 (v) =
P2 + v(P2 − P3 ), v > 0 intersect, and constraint (13) holds.
(vi) Two line segments P0 P1 and P2 P3 intersect, and constraint
(13) holds.
(vii) Ray R(u) = P3 + u(P3 − P2 ), u > 0 and edge P0 P1 intersect,
and constraint (13) holds.
(viii) Ray R(u) = P0 + u(P0 − P1 ), u > 0 and edge P2 P3 intersect,
and constraint (13) holds.
Proof. Conditions (i)–(viii) actually correspond to Cases 1–8,
respectively. Thus what remains is just to prove that if a
Bézier control polygon is given as in Cases 5–8, the Bézier curve is
an indirect-PH curve. In fact, we simply let


h=2

Eliminating h gives



d1
l1


+1

d2
l3



T0 =

1

−1 =− .

(16)

4

Referring to Fig. 8, the interior angle α in this case is a
reflex angle. In △P0 IP3 , the Law of Sines gives
d1
sin β

=

l0
sin(2π − α − β)
sin β

=

d2
sin(α − π )

Thus d1 = − sin(α+β) l0 , d2 =
them into (16) gives (13).

.

sin α
l .
sin(α+β) 0

Substituting

Summarizing all the above discussions, we arrive at the main
result of the paper:
Theorem 5. A properly-parameterized cubic Bézier curve P (t ) of (6)
is an indirect-PH curve if and only if the four control points P0 , P1 , P2
and P3 do not lie on the same line, P0 ̸= P3 , and they further satisfy
one of the following eight conditions (corresponding to Fig. 9 (a)–(h)):
(i) P0 = P1 .
(ii) P2 = P3 .
(iii) P2 = P3 + 34 (P0 − P3 ).
(iv) P1 = P0 + 34 (P3 − P0 ).

l0

sin β

l1 sin(α + β)
3

ρ0

(P1 − P0 ),



−1 ,
T1 =

ρ1 = hρ0 ,
3
hρ 0

(P3 − P2 ).

Then it is easy to verify that the constraint (13) makes the condition
(5) in Theorem 2 be satisfied.
Remark 2. According to Corollary 3, the condition for a cubic
indirect-PH curve to have no cusp is h > 0. Therefore, among
the eight cases for indirect-PH curves, only Case 5 defines curves
that do not contain cusps within the parameter domain [0, 1].
Moreover, in this case, the control polygons are convex, so the
curves cannot have an inflection point.
Remark 3. Given P0 , P1 and P3 such that they are not collinear,
P0 P1 and P0 P3 form a 2D affine frame. We construct two lines: One
line goes through P1 and P3 , and the other goes through P3 and is
parallel to P0 P1 . As shown in Fig. 10, these lines together with lines
P0 P1 and P0 P3 partition the plane into nine zones. If a Bézier curve
defined by P0 , P1 , P2 and P3 is an indirect-PH curve, the control
point P2 must be at P3 , P3 + 43 (P0 − P3 ), or one of four shaded zones
(i.e., I, II, III and IV). Specifically, zones I, II, III and IV correspond
to Cases 5, 6, 7 and 8, respectively. Thus this figure provides a
characterization diagram for Bézier control points of indirect-PH
curves.

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45

41

Fig. 9. Eight possible patterns of Bézier control polygons for cubic indirect-PH curves.

Fig. 11. Construction of a single indirect-PH curve.
Fig. 10. The four shaded zones are the possible location for P2 , corresponding to
Cases 5–8.

Remark 4. If we are required to examine whether a cubic spline
consists of indirect-PH curves, a simple way is just to convert each
segment into a Bézier curve by knot insertion and then to apply
Theorem 5.

P1 = P0 + l1

4. G 1 Hermite interpolation
This section considers the G1 Hermite interpolation problem:
given two points P0 and P3 and two respective tangent vectors T0
and T1 , we want to find a cubic indirect-PH curve P (t ) satisfying
P (0) = P0 ,

P (1) = P3 ,

Bézier form. It is obvious that the given two points P0 and P3 serve
as the first and last Bézier control points. To further achieve G1
Hermite interpolation, the two inner Bézier control points P1 and
P2 should be placed on rays R0 (u) and R1 (v), respectively. Using
the notations introduced in the preceding section, P1 and P2 are
expressed as

P ′ (0) = c0 T0 ,

P ′ (1) = c1 T1

(17)

for some positive numbers c0 and c1 . Moreover, the constructed
curve P (t ) is required not to contain cusps since cusps are usually
not desirable.
We first construct two rays R0 (u) = P0 + uT0 , u ∈ (0, +∞) and
R1 (v) = P3 − v T1 , v ∈ (0, +∞). If R0 (u) and R1 (v) intersect, there
exist cubic indirect-PH curves achieving G1 Hermite interpolation
according to Theorem 5. We discuss the construction of such curves
in Section 4.1. Otherwise, there is no intersection between R0 (u)
and R1 (v). Then according to Theorem 5, there may not exist
an indirect-PH curve as the solution to the problem, or there
do exist indirect-PH curves satisfying G1 Hermite interpolation
but the curves contain cusp(s). We propose to use two indirectPH curves connected with G1 continuity to achieve G1 Hermite
interpolation and these curves do not contain cusps. We discuss
this in Section 4.2.
4.1. Constructing a single indirect-PH curve
Assume that R0 (u) and R1 (v) intersect at I as shown in Fig. 11.
We look for a single indirect-PH curve P (t ) as the solution to the
G1 Hermite interpolation problem. We express P (t ) using cubic

T0

∥T0 ∥

,

P2 = P3 − l3

T1

(18)

∥T 1 ∥

where l1 and l3 should be properly chosen in order to assure P (t )
to be an indirect-PH curve.
In order to make sure that constraint (13) holds, we let
l0

sin β

−1=

l1 sin(α + β)

h
2

l0

,

sin α

l3 sin(α + β)

−1=

1
2h

where h is a parameter that can be used for shape control. Solving
these two equations gives
l1 =

sin β

2l0

h + 2 sin(α + β)

,

l3 =

sin α

2hl0

2h + 1 sin(α + β)

.

(19)

Since α, β and α + β are all in (0, π ) in this case, to guarantee the
positivity of both l1 and l3 obtained from the above two equations, h
must satisfy either h > 0 or −2 < h < − 21 . When −2 < h < − 12 ,
sin β

sin β

α
α
l1 > 30 sin(α+β) > l0 sin(α+β) , and l3 > 30 sinsin
> l0 sinsin
,
(α+β)
(α+β)
which correspond to Case 6. Similar analysis shows that h > 0
corresponds to Case 5. Since Case 5 is the only case where there is
no cusp, we restrict our discussion to h > 0.
So far we have constructed a family of cubic Bézier curves
characterized by parameter h, which are indirect-PH curves and
satisfy the requirement of G1 Hermite interpolation. Next we show
how to select a ‘‘good’’ one from the family. Our criterion is that the
integral of the square norm of the second order derivative of the
curve is minimized, which is often used in fair curve design. Thus
the problem is to solve
4l

1



∥P ′′ (t )∥2 dt .

h = arg min
h >0

4l

0

(20)

42

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45


2
−12m2 − 3m − 12n2 + 4 = −12 m + 81 − 12n2 + 67
<
16

2
1
2
′
=
−
−
12n
<
0.
Therefore
F
(
h
)
<
−12 21 + 18 − 12n2 + 67
16
2
F ′ (0) < 0 for h ∈ (0, r ], and F ′ (h) has only one root in (r , ∞).
Denote the root by c. Then F ′ (h) < 0 for h ∈ (0, c ) and F ′ (h) > 0
for h ∈ (c , +∞). Therefore we can prove that F (h) = 0 has a
unique solution in (0, +∞) in a similar analysis.
Therefore for any positive h less than the root of F (h) = 0, F (h)
is negative, so is (21), and for any h greater than the root, F (h) and
(21) are positive. Therefore at the root of F (h) = 0, the integration
in (20) reaches its minimum.
Finally, we can easily verify the following inequalities:

Fig. 12. Construction of control structure for two indirect-PH curves.

F (0.49) ≤ −15.77643588(m − 0.1383071871617178)2

We have the following theorem for this:

− 15.77643588n2 − 0.0069794624518767 < 0

Theorem 6. Among all the constructed indirect-PH curves P (t ), the
minimization problem (20) has a unique solution. Moreover, the
solution h is within (0.49, 2.04).
Proof. Note that the integration in (20) remains the same under a
rigid transformation. Hence without loss of generality we assume
that P0 = (0, 0), P3 = (l, 0) and I = (lm, ln) where l, m, n are real
numbers and l > 0, n > 0. Then P (t ) can be represented by
P (t ) =

2l
(m, n)B31 (t )
h+2
2hl
+
(m + 2h, n)B32 (t ) + l(1, 0)B33 (t ).
2h + 1

Some calculations give
d
dh



72l2 F (h)

1

∥P ′′ (t )∥2 dt =

0

(21)

(h + 2)2 (2h + 1)3

where

F (2.04) ≥ 273.22294272(m − 0.8620652619256)2

+ 273.22294272n2 + 0.0455229664307 > 0.
This means that the solution of F (h) = 0 is within (0.49, 2.04).
Theorem 6 also provides a way to finding h. That is to find the
root of F (h) = 0 within (0.49, 2.04). The theorem has assured that
there exists a unique solution. The Bézier clipping method [38] can
be used to quickly find the solution. Thus given the G1 Hermite
data {P0 , T0 ; P3 , T1 }, the construction of G1 Hermite interpolation
proceeds as follows: (1) compute the two angles α and β ; (2) find
the optimal h; (3) compute l1 and l3 using Eq. (19); and (4) compute
P1 and P2 using Eq. (18), which together with P0 , P3 define the
target cubic Bézier curve.
4.2. Constructing two indirect-PH curves
When R0 (u) and R1 (v) do not intersect, a single cubic indirectPH curve without cusp(s) is not available for the given Hermite
data. We resort to two indirect-PH curve segments that are connected with G1 continuity and satisfy the interpolation condition.
This is always possible.
The basic idea is to introduce two points Q1 and Q2 as follows:

F (h) = 2(6m2 − 3m + 6n2 + 1)h4

+ (12m2 − 27m + 12n2 + 11)h3
+ 18(−2m + 1)h2 + (−12m2 − 3m − 12n2 + 4)h
+ 2(−6m2 + 9m − 6n2 − 4).

Q1 = P0 + aT0 ,

Hence
F (h) = 8(6m − 3m + 6n + 1)h
′

2

2

3

+ 3(12m2 − 27m + 12n2 + 11)h2
+ 36(−2m + 1)h + (−12m2 − 3m − 12n2 + 4),
F ′′ (h) = 24(6m2 − 3m + 6n2 + 1)h2

+ 6(12m2 − 27m + 12n2 + 11)h + 36(−2m + 1).
Since F (0) = 4(−6m2 +9m−6n2 −4) = −24(m− 43 )2 −24n2 − 25 <

0 and 6m2 − 3m + 6n2 + 1 = 6(m − 14 )2 + 6n2 + 85 > 0, F (h) = 0
has at least one solution in (0, +∞). Next we show that there is
exactly one solution in (0, +∞).
If m ≤
12n2 −

and

67
16

1
,
2



then 12m2 − 27m + 12n2 + 11 = 12 m −

≥ 12

1
2

−


27 2
24

F ′′ (h) has a minimum at h = −

=



+

+ 12n2 > 0. Hence

67
1
16
2
2
2
12m −27m+12n +11
8(6m2 −3m+6n2 +1)

+ 12n2 −

27 2
24

< 0, from which
and F ′′ (0) = 36(−2m + 1) ≥ 0 we can conclude F ′′ (h) > 0 for all
h > 0. This implies that F ′ (h) has at most one root in (0, +∞). If
F ′ (h) = 0 has no solution, then F ′ (h) > 0 for h > 0 and F (h) = 0
has a unique solution in (0, +∞). Otherwise, F ′ (h) has one root
c ∈ (0, +∞). Then F ′ (h) < 0 for h ∈ (0, c ) and F ′ (h) > 0 for
h ∈ (c , +∞). Therefore, F (h) < F (0) < 0 for h ∈ (0, c ], and
F (h) = 0 has a unique solution in [c , ∞).
Otherwise, m > 21 . F ′′ (0) = 36(−2m + 1) < 0. Thus F ′′ (h) = 0
has one solution in (0, ∞), which we denote by r. For h ∈ (0, r ),
F ′′ (h) < 0 and for h ∈ (r , ∞), F ′′ (h) > 0. Meanwhile, F ′ (0) =

Q2 = P3 − bT1

with some positive numbers a and b. Then we choose a point
Pm on line segment Q1 Q2 . In this way, we can obtain two sets
of data: {P0 , T0 ; Pm , Q1 Q2 } and {Pm , Q1 Q2 ; P3 , T1 }. Each set of the
data satisfies the assumption in Section 4.1. We can thus apply
the procedure presented there to construct two indirect-PH curve
segments which satisfy G1 Hermite interpolation and also join at
Pm with G1 continuity.
While there are many ways to choose a, b and Pm , we here
describe a heuristic way to determine them automatically. The
underlying consideration is the balance of the two indirect-PH
curve segments in terms of length and shape, and the simplicity of
the method. Denote by l0 the length of P0 P3 . The process consists
of the following three steps (with reference to Fig. 12):
(1) Construct a rectangle centered at P0 . One pair of edges is
parallel to P0 P3 and the other pair of edges is orthogonal to P0 P3 .
The length of the edges parallel to P0 P3 is chosen to be l0 /2 and
the length of the other pair of edges is chosen to be l0 . Cast a
ray starting from P0 along the direction of T0 . The intersection
between the ray and the rectangle is selected to be Q1 .
(2) Similar to step (1), construct a rectangle centered at P3 . The
intersection between the rectangle and a ray starting from P3
along the direction of −T1 is selected to be Q2 .
(3) Note that Q1 and Q2 are on the two sides of the perpendicular
bisector of P0 P3 . The intersection between Q1 Q2 and the
perpendicular bisector is chosen to be Pm .

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45

43

could be
t (s) =

Fig. 13. A cubic Bézier curve (red) and its 3 offset curves (blue). (For interpretation
of the references to color in this figure legend, the reader is referred to the web
version of this article.)

A simple situation is that T0 = −T1 and T0 , T1 are perpendicular
to P0 P3 . Then the above procedure produces Q1 , Q2 and Pm such
that P0 Q1 , Q1 Pm , Pm Q2 , and Q2 P3 have the same length and P0 Q1 Pm
and Pm Q2 P3 are the same up to a rigid transformation. Similarly, if
T0 = T1 and they are perpendicular to P0 P3 , the constructed two
sets of data are symmetric.

5. Examples
This section provides more examples of indirect-PH curves in
addition to those given in Section 3.
Fig. 13 shows a cubic Bézier curve in red and its control polygon.
The Cartesian coordinates of the four control points are (0, 0), (0,
5.6), (3, 4), and (6, 1). It can be verified that this Bézier control
polygon corresponds to Case 5 and the constraint (13) holds. Thus
the curve has rational offsets. In fact, a parameter transformation

0.4109643s2 − 2s
2.882843864s2 − 3.913301496s − 0.558578068

,

and the offset curves are rational Bézier curves of degree of 8. Three
offset curves and their control polygons are depicted in blue.
Given two endpoints P0 = (0, 0), P3 = (1, 1) and their respective tangent vectors T0 = (1, 4), T1 = (1.5, −1), there exists
a family of indirect-PH curves that achieve G1 Hermite interpolation. Fig. 14 shows five such curves from the family with parameter h = 0.1, 1, 1.568665207, 2.5, 15 from left to right. In
particular, when h = 1, the indirect-PH curve is actually a
quadratic Bézier curve. h = 1.568665207 is the optimal solution
to the minimization problem (20). As a comparison, we also construct the cubic PH curve which is displayed on the right of Fig. 14.
Different from indirect-PH curves, the PH curve is unique for the
given G1 Hermite data. In the bottom row of the figure, the curvature plots of the curves are presented.
When the given G1 Hermite data do not satisfy the assumption
in Section 4.1, a single indirect-PH curve without cusp(s) is
not available. Then two indirect-PH curves can be used. Fig. 15
shows the construction of two indirect-PH curves under various
situations. It can be seen that such bi-indirect-PH curves possess
enough flexibility for G1 Hermite interpolation. In Fig. 15, the
input data (two endpoints and two vectors) are displayed in green.
The two constructed curves and their control polygons are shown
in blue and black, respectively. The joint point between the two
indirect-PH curves is drawn in red.
Finally, Figs. 16 and 17 show G1 spline curves consisting of
several indirect-PH curves that interpolate a sequence of Hermite
data. This is done by automatically constructing indirect-PH

Fig. 14. G1 Hermite interpolation. The G1 Hermite data are shown in green. Top row: Bézier curves and their control polygons; bottom row: curvature plots. From left to
right: indirect-PH curves with h = 0.1, 1, 1.568665207, 2.5, 15, and a PH curve. (For interpretation of the references to color in this figure legend, the reader is referred to
the web version of this article.)

Fig. 15. Five situations for bi-indirect-PH curve construction. (For interpretation of the references to color in this figure legend, the reader is referred to the web version of
this article.)

44

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45

Fig. 16. Left: input data. Middle: G1 interpolating spline consisting of indirect-PH curves (red) and their control polygons. Right: 4 rational offsets (blue). (For interpretation
of the references to color in this figure legend, the reader is referred to the web version of this article.)

Fig. 17. Left: input data. Middle: G1 interpolating spline consisting of indirect-PH curves (red) and their control polygons. Right: 4 rational offsets (blue). (For interpretation
of the references to color in this figure legend, the reader is referred to the web version of this article.)

curve(s) for each adjacent pair of data. The input data points for
the closed curve in Fig. 16 are (−8, 0), (−2.5, −3), (3, −5), (8, 0),
(3, 5), (−2.5, 3), (−8, 0), and their respective tangent vectors are
(0, −1), (2, 1), (4, −1), (0, 1), (−4, −1), (−2, 1), (0, −1). It can
be seen that two indirect-PH curves are used for the span between
points (−2.5, −3) and (3, −5), and the span between points
(3, 5) and (−2.5, 3). The data points for the open curve in Fig. 17
are (−12, −4), (−6, −3), (−2, 2), (4, 4), (9, 1), (6, −4), and
their respective tangent vectors are (1, 0), (1, 1), (1.2, 1), (3, 0),
(0, −1), (−2, −1). Similarly, it can be seen that two indirect-PH
curves are constructed in the span between points (−6, −3) and
point (−2, 2).
6. Conclusion
We have derived the geometric characteristics of a class of
cubic Bézier curves, called indirect-PH curves, which are not PH
curves but can have rational Pythagorean hodographs after a
quadratic parameter transformation. The characteristics are given
in terms of Bézier control polygon geometry. The offsets to this
class of Bézier curves are generally degree 8 rational curves. The
construction of G1 Hermite interpolation using such curves is
described. A single cubic indirect-PH curve has just one more
degree of freedom than a quadratic Bézier curve, but bi-indirectPH curves possess enough flexibility for G1 Hermite interpolation
and shapes containing an inflection point.
While this paper focuses on the geometric characteristics
of indirect-PH curves and their construction for G1 Hermite
interpolation, it is interesting to combine them with PH curves in
free form shape design. In addition, extending the current work
to rational indirect-PH curves and quartic or quintic indirect-PH
curves warrants further investigation since they provide more
degrees of freedom.
Acknowledgments
This research is partially supported by National Natural Science
Foundation of China (Grant No. 61272300), Singapore Millennium
Foundation which is funded by Temasek Trust, and MOE AcRF Tier
1 Grant of Singapore (RG10/12).
References
[1] Farin G, Hoschek J, Kim M. Handbook of computer aided geometric design.
Elsevier; 2002.
[2] Farouki RT, Neff CA. Analytic properties of plane offset curves. Comput Aided
Geom Design 1990;7(1-4):83–99.

[3] Klass R. An offset approximation for planar cubic splines. Comput-Aided Des
1983;15:297–9.
[4] Tiller W, Hanson E. Offsets of two-dimensional profiles. IEEE Comput Graph
Appl 1984;4(9):36–46.
[5] Coquillart S. Computing offsets of B-spline curves. Comput-Aided Des 1987;
19(6):305–9.
[6] Pham B. Offset curves and surfaces: a brief survey. Comput-Aided Des 1992;
24(4):223–9.
[7] Elber G, Lee I-K, Kim M-S. Comparing offset curve approximation methods.
IEEE Comput Graph Appl 1997;17(3):62–71.
[8] Maekawa T. An overview of offset curves and surfaces. Comput-Aided Des
1999;31(3):165–73.
[9] Farouki RT, Sakkalis T. Pythagorean hodographs. IBM J Res Dev 1990;34:
736–52.
[10] Farouki RT, Šír Z. Rational Pythagorean-hodograph space curves. Comput
Aided Geom Design 2011;28(2):75–88.
[11] Pottmann H. Rational curves and surfaces with rational offsets. Comput Aided
Geom Design 1995;12(2):175–92.
[12] Farouki RT, Šír Z. Rational Pythagorean-hodograph space curves. Comput
Aided Geom Design 2011;28(2):75–88.
[13] Moon HP. Minkowski Pythagorean hodographs. Comput Aided Geom Design
1999;16(8):739–53.
[14] Farouki RT, Neff CA. Hermite interpolation by Pythagorean-hodograph
quintics. Math Comp 1995;64:1589–609.
[15] Moon HP, Farouki RT, Choi HI. Construction and shape analysis of PH quintic
Hermite interpolants. Comput Aided Geom Design 2001;18(2):93–115.
[16] Kosinka J, Jüttler B. G1 Hermite interpolation by Minkowski Pythagorean
hodograph cubics. Comput Aided Geom Design 2006;23(5):401–18.
[17] Kong JH, Jeong SP, Lee S, Kim G-I. C 1 Hermite interpolation with simple planar
PH curves by speed reparametrization. Comput Aided Geom Design 2008;
25(4–5):214–29.
[18] Byrtus M, Bastl B. G1 Hermite interpolation by PH cubics revisited. Comput
Aided Geom Design 2010;27(8):622–30.
[19] Kong JH, Lee HC, Kim G-I. C 1 Hermite interpolation with PH curves by
boundary data modification. J Comput Appl Math 2013;248:47–60.
[20] Farouki RT. Pythagorean-hodograph curves: Algebra and geometry inseparable. 1st ed. Springer Publishing Company, Incorporated; 2007.
[21] Farouki RT, Jüttler B, Manni C. Preface: Pythagorean-hodograph curves and
related topics. Comput Aided Geom Design 2008;25(4–5):203–4.
[22] Kosinka J, Lávicka M. Pythagorean hodograph curves: A survey of recent
advances. J Geom Graph 2014;18(1):23–43.
[23] Farouki RT, Sederberg TW. Analysis of the offset to a parabola. Comput Aided
Geom Design 1995;12(6):639–45.
[24] Zheng J. On rational representation of offset curves. Chinese Sci Bull 1995;
40(1):9–10.
[25] Lu W. Offset-rational parametric plane curves. Comput Aided Geom Design
1995;12(6):601–16.
[26] Wang G-J, Wang G-Z, Zheng J. Computer aided geometric design. Beijing:
CHEP-Springer; 2001.
[27] Farouki RT. The conformal map z ->z2 of the hodograph plane. Comput Aided
Geom Design 1994;11(4):363–90.
[28] Choi HI, Lee DS, Moon HP. Clifford algebra, spin representation and rational
parametrization of curves and surfaces. Adv Comput Math 2002;17:5–48.
[29] Farouki RT, al-Kandari M, Sakkalis T. Hermite interpolation by rotationinvariant spatial Pythagorean-hodograph curves. Adv Comput Math 2002;
17(4):369–83.
[30] Wang G, Fang L. On control polygons of quartic Pythagorean-hodograph
curves. Comput Aided Geom Design 2009;26(9):1006–15.

X.-J. Lu et al. / Computer-Aided Design 70 (2016) 36–45
[31] Pelosi F, Sampoli ML, Farouki RT, Manni C. A control polygon scheme for design
of planar C2 PH quintic spline curves. Comput Aided Geom Design 2007;24(1):
28–52.
[32] Wang C. Shape classification of the parametric cubic curve and parametric Bspline cubic curve. Comput-Aided Des 1981;13(4):199–206.
[33] Su B, Liu D. An affine invarient and its application in computational geometry.
Sci Sin Ser A 1983;24(3):259–67.
[34] Stone MC, DeRose TD. A geometric characterization of parametric cubic curves.
ACM Trans Graph 1989;8(3):147–63.

45

[35] Ahn YJ, Hoffmann CM. Approximate convolution with pairs of cubic Bézier LN
curves. Comput Aided Geom Design 2011;28:357–67.
[36] Jütler B. Triangular Bézier surface patches with a linear normal vector
field. In: The mathemtaics of surfaces viii, information geometers. 1998,
p. 431–46.
[37] Gravesen J, Jütler B, Šir Z. On rationally supported surfaces. Comput Aided
Geom Design 2008;25:320–31.
[38] Sederberg TW, Nishita T. Curve intersection using Bézier clipping. ComputAided Des 1990;22(9):538–49.

